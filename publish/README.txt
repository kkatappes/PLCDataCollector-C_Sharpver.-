================================================================================
                    Andon PLC通信システム - 実行ファイル
================================================================================

【概要】
このフォルダには、PLC通信データ取得・記録システムの実行ファイルが含まれています。
1秒ごとにPLCと通信し、デバイスデータを取得・記録します。

================================================================================
【フォルダ構成】
================================================================================

publish/
├── andon.exe               - 実行ファイル（このファイルを実行）
├── appsettings.json        - アプリケーション設定ファイル
├── config/                 - PLC接続設定Excelファイル格納フォルダ
│   └── 5JRS_N2.xlsx        - PLC接続設定ファイル（例）
└── logs/                   - ログファイル出力フォルダ（自動生成）
    ├── andon.log           - アプリケーションログ（自動生成）
    └── terminal_output.txt - コンソール出力ログ（自動生成）

================================================================================
【実行方法】
================================================================================

1. フォルダ構成を確認
   - andon.exe
   - appsettings.json
   - config/ フォルダ（*.xlsx ファイルが必要）

2. 設定ファイルを配置
   config/ フォルダに、PLC接続設定を記載したExcelファイル（*.xlsx）を配置

3. 実行
   - 方法1: andon.exe をダブルクリック
   - 方法2: コマンドプロンプトから実行
     ```
     cd （publishフォルダのパス）
     andon.exe
     ```

4. 停止
   Ctrl+C を押す、またはコマンドプロンプトを閉じる

================================================================================
【設定ファイル】
================================================================================

■ appsettings.json
  - アプリケーション全体の設定
  - MonitoringIntervalMs: PLC通信間隔（ミリ秒、デフォルト1000=1秒）
  - LoggingConfig: ログ出力設定

■ config/*.xlsx (Excelファイル)
  - PLC接続情報（IPアドレス、ポート、通信方式など）
  - デバイス情報（デバイスタイプ、デバイス番号など）
  - 複数のExcelファイルを配置すると、すべてのPLCに順次接続します

================================================================================
【ログファイル】
================================================================================

■ logs/andon.log
  - アプリケーション動作ログ
  - PLC通信の成功/失敗
  - エラー情報

■ logs/terminal_output.txt
  - コンソール出力の記録

※ログファイルは自動的にローテーションされます（設定で変更可能）

================================================================================
【トラブルシューティング】
================================================================================

■ プログラムが起動しない
  1. .NET 9.0 ランタイムがインストールされているか確認
  2. appsettings.json が正しく配置されているか確認
  3. logs/ フォルダが作成できる権限があるか確認

■ PLC接続エラー
  1. config/*.xlsx の設定を確認
     - IPアドレス、ポート番号が正しいか
     - 通信方式（TCP/UDP）が正しいか
  2. PLCの電源が入っているか確認
  3. ネットワーク接続を確認（ping コマンドで疎通確認）
  4. logs/andon.log でエラー詳細を確認

■ ログファイルが作成されない
  1. logs/ フォルダの書き込み権限を確認
  2. appsettings.json の LoggingConfig を確認
     - EnableFileOutput が true になっているか

================================================================================
【本番環境での推奨事項】
================================================================================

1. 定期的なログファイルのバックアップ
2. ディスク容量の監視
3. システム起動時の自動実行設定（必要に応じて）
4. 異常終了時の自動再起動設定（必要に応じて）

================================================================================
【お問い合わせ】
================================================================================

不明点や問題が発生した場合は、logs/andon.log の内容を確認の上、
システム管理者にお問い合わせください。

================================================================================
                                                        バージョン: 1.0.0
                                                        作成日: 2025-12-01
================================================================================
