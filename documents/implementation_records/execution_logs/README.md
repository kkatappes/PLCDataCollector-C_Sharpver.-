# 実行ログ・テスト結果 (Execution Logs)

このフォルダーには、実装したメソッドの実行ログ、テスト結果、デバッグ情報を保存します。

## 記録の目的

- **動作確認**: 実装したメソッドが正常に動作することの証跡
- **パフォーマンス測定**: 実行時間、メモリ使用量、スループットの記録
- **エラー追跡**: 発生したエラーの詳細ログと対処結果
- **テスト結果**: 単体テスト、統合テスト、負荷テストの結果
- **デバッグ情報**: 問題調査時の詳細ログとその分析

## ファイル命名規則とフォルダー構成

### 📁 フォルダー構成
```
execution_logs/
├── unit_tests/          # 単体テスト結果
├── integration_tests/   # 統合テスト結果
├── performance_tests/   # パフォーマンステスト結果
├── debug_logs/          # デバッグログ
├── runtime_logs/        # 実行時ログ
└── error_logs/          # エラーログ
```

### 📄 ファイル命名規則

#### テスト結果ファイル
```
{YYYY-MM-DD-HHMM}_{テスト種別}_{対象}_結果.md
例: 2024-10-28-1430_UnitTest_SlmpClient_結果.md
    2024-10-28-1500_IntegrationTest_TCP通信_結果.md
    2024-10-28-1600_PerformanceTest_メモリ使用量_結果.md
```

#### 実行ログファイル
```
{YYYY-MM-DD-HHMM}_{機能名}_実行ログ.log
例: 2024-10-28-1430_SLMP通信_実行ログ.log
    2024-10-28-1500_デバイス監視_実行ログ.log
```

#### デバッグログファイル
```
{YYYY-MM-DD-HHMM}_{問題内容}_デバッグログ.log
例: 2024-10-28-1430_接続タイムアウト_デバッグログ.log
    2024-10-28-1500_メモリリーク調査_デバッグログ.log
```

## 📊 テスト結果記録テンプレート

### 単体テスト結果テンプレート

```markdown
# 単体テスト結果報告

## 📋 テスト概要
- **実行日時**: YYYY-MM-DD HH:MM:SS
- **テスト対象**: [クラス名.メソッド名]
- **テストフレームワーク**: xUnit / NUnit / MSTest
- **実行環境**: [OS, .NET バージョン, etc.]

## 🎯 テスト項目

### テストケース1: [テスト名]
- **目的**: [テストの目的]
- **入力**: [テスト入力データ]
- **期待結果**: [期待される結果]
- **実際の結果**: [実際の結果]
- **結果**: ✅ PASS / ❌ FAIL
- **実行時間**: [N ms]

### テストケース2: [テスト名]
- **目的**: [テストの目的]
- **入力**: [テスト入力データ]
- **期待結果**: [期待される結果]
- **実際の結果**: [実際の結果]
- **結果**: ✅ PASS / ❌ FAIL
- **実行時間**: [N ms]

## 📈 テスト結果サマリー
- **総テスト数**: [N個]
- **成功**: [N個] ([N%])
- **失敗**: [N個] ([N%])
- **スキップ**: [N個] ([N%])
- **総実行時間**: [N秒]
- **コードカバレッジ**: [N%]

## 🐛 失敗したテストの詳細
### [失敗テスト名]
- **失敗理由**: [詳細な失敗理由]
- **スタックトレース**:
```
[スタックトレースの内容]
```
- **修正方針**: [修正予定内容]

## 📝 備考・所感
- [テスト実行時の気づき]
- [改善すべき点]
- [次回に向けた改善案]
```

### パフォーマンステスト結果テンプレート

```markdown
# パフォーマンステスト結果

## 📋 テスト概要
- **実行日時**: YYYY-MM-DD HH:MM:SS
- **テスト対象**: [機能名/メソッド名]
- **テスト環境**:
  - CPU: [CPU情報]
  - メモリ: [メモリサイズ]
  - OS: [OS情報]
  - .NET Version: [バージョン]

## 🎯 測定項目

### 実行時間測定
- **測定対象**: [メソッド名]
- **実行回数**: [N回]
- **平均実行時間**: [N ms]
- **最短時間**: [N ms]
- **最長時間**: [N ms]
- **標準偏差**: [N ms]

### メモリ使用量測定
- **実行前メモリ**: [N MB]
- **実行後メモリ**: [N MB]
- **最大使用メモリ**: [N MB]
- **GC発生回数**: [N回]
- **メモリリーク**: あり/なし

### スループット測定
- **処理件数**: [N件]
- **処理時間**: [N秒]
- **スループット**: [N件/秒]
- **CPU使用率**: [N%]

## 📊 ベンチマーク比較
### 実装前 vs 実装後
| 項目 | 実装前 | 実装後 | 改善率 |
|------|--------|--------|--------|
| 実行時間 | [N ms] | [N ms] | [+/-N%] |
| メモリ使用量 | [N MB] | [N MB] | [+/-N%] |
| スループット | [N/s] | [N/s] | [+/-N%] |

## 🔍 ボトルネック分析
- **特定されたボトルネック**: [詳細]
- **改善提案**: [具体的な改善案]
- **優先度**: High/Medium/Low

## 📈 目標との比較
- **実行時間目標**: [N ms] → 実績: [N ms] (達成/未達成)
- **メモリ目標**: [N MB] → 実績: [N MB] (達成/未達成)
- **スループット目標**: [N/s] → 実績: [N/s] (達成/未達成)
```

## 🔧 実行ログフォーマット

### ランタイムログ
```
[2024-10-28 14:30:15.123] [INFO] [SlmpClient] 接続開始: 192.168.1.100:5000
[2024-10-28 14:30:15.456] [DEBUG] [SlmpClient] TCP接続確立完了
[2024-10-28 14:30:15.789] [INFO] [SlmpClient] SLMPフレーム送信: コマンド=0x0401
[2024-10-28 14:30:16.012] [DEBUG] [SlmpClient] 受信データ: 48 bytes
[2024-10-28 14:30:16.345] [INFO] [SlmpClient] デバイス読み取り完了: M100-M199
[2024-10-28 14:30:16.678] [WARN] [SlmpClient] 接続タイムアウト警告: 3秒経過
[2024-10-28 14:30:16.901] [ERROR] [SlmpClient] 通信エラー: SocketException
```

### デバッグログ
```
=== DEBUG SESSION START: 2024-10-28 14:30:00 ===
Target: SlmpClient.ConnectAsync()
Issue: 接続タイムアウトが頻発

[14:30:05] 接続試行開始
[14:30:05] TCP接続パラメータ: Timeout=5000ms, Buffer=1024bytes
[14:30:07] TCP接続応答なし (2秒経過)
[14:30:10] TCP接続タイムアウト (5秒経過)
[14:30:10] 例外発生: System.Net.Sockets.SocketException

分析結果:
- PLCの応答が遅い (ネットワーク遅延?)
- タイムアウト値が短すぎる可能性
- ファイアウォール設定の影響?

対処方針:
1. タイムアウト値を10秒に延長
2. リトライロジックの追加
3. ネットワーク状況の確認

=== DEBUG SESSION END: 2024-10-28 14:45:00 ===
```

## 📁 ログ管理・運用

### 🔄 ログローテーション
- **日次ローテーション**: 毎日0時に新しいログファイル作成
- **サイズベース**: ログファイルが10MBを超えたら分割
- **保存期間**: 30日間保存後、アーカイブまたは削除

### 📊 ログ分析
- **定期レビュー**: 週次でエラーパターン分析
- **トレンド監視**: パフォーマンスの推移を月次レポート
- **アラート設定**: 重要なエラーパターン検出時の通知

### 🔍 検索・活用
- **キーワード検索**: エラーメッセージやメソッド名での検索
- **時系列分析**: 特定時間帯の問題調査
- **相関分析**: 複数ログ間の関連性分析

## 🛠️ ツールとスクリプト

### ログ収集スクリプト例
```batch
@echo off
REM 実行ログ収集バッチ
set LOG_DIR=C:\Users\1010821\Desktop\python\andon\documents\implementation_records\execution_logs
set DATE_TIME=%date:~-10,4%-%date:~-5,2%-%date:~-2,2%-%time:~0,2%%time:~3,2%

REM アプリケーション実行してログ収集
cd /d "C:\Users\1010821\Desktop\python\andon"
andon.exe > "%LOG_DIR%\runtime_logs\%DATE_TIME%_実行ログ.log" 2>&1

echo ログ収集完了: %LOG_DIR%\runtime_logs\%DATE_TIME%_実行ログ.log
```

### パフォーマンス測定スクリプト例
```powershell
# パフォーマンス測定PowerShellスクリプト
$logDir = "C:\Users\1010821\Desktop\python\andon\documents\implementation_records\execution_logs\performance_tests"
$timestamp = Get-Date -Format "yyyy-MM-dd-HHmm"

# メモリ使用量測定
$beforeMemory = [GC]::GetTotalMemory($false)
# ここで対象メソッド実行
$afterMemory = [GC]::GetTotalMemory($false)

$result = @"
パフォーマンス測定結果: $timestamp
実行前メモリ: $beforeMemory bytes
実行後メモリ: $afterMemory bytes
メモリ増加量: $($afterMemory - $beforeMemory) bytes
"@

$result | Out-File "$logDir\$timestamp_メモリ測定結果.log"
```

## 📈 継続的改善

### 品質指標の監視
- **テスト成功率**: 95%以上を維持
- **パフォーマンス**: 目標値からの乖離監視
- **エラー発生率**: 月次でトレンド分析

### 効率化・自動化
- **自動テスト実行**: CI/CDパイプラインでの自動実行
- **ログ分析の自動化**: 異常パターン自動検出
- **レポート生成**: 定期的な自動レポート作成