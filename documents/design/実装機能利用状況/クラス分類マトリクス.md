# ã‚¯ãƒ©ã‚¹åˆ†é¡ãƒãƒˆãƒªã‚¯ã‚¹

**ä½œæˆæ—¥**: 2025-12-02
**åˆ†é¡è»¸**: DIç™»éŒ²æœ‰ç„¡ Ã— æœ¬ç•ªåˆ©ç”¨æœ‰ç„¡

---

## ğŸ“Š åˆ†é¡ãƒãƒˆãƒªã‚¯ã‚¹

### 1ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š âœ… (æ­£å¸¸ã«æ©Ÿèƒ½ä¸­)

#### Controllerså±¤
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|--------|-------------|-------------|
| ApplicationController | âœ… | Singleton | AndonHostedService.ExecuteAsync() |
| ExecutionOrchestrator | âœ… | Transient | ApplicationController.StartContinuousDataCycleAsync() |
| ConfigurationWatcher | âœ… | Singleton | ApplicationController.StartAsync() |

#### Managerså±¤
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|--------|-------------|-------------|
| ConfigToFrameManager | âœ… | Transient | ExecutionOrchestrator.ExecuteMultiPlcCycleAsync_Internal() |
| PlcCommunicationManager | âœ… | å‹•çš„ç”Ÿæˆ | ExecutionOrchestrator.ExecuteMultiPlcCycleAsync_Internal() |
| DataOutputManager | âœ… | Transient | ExecutionOrchestrator.ExecuteMultiPlcCycleAsync_Internal() |
| LoggingManager | âœ… | Singleton | å…¨ä½“ã§ä½¿ç”¨ï¼ˆApplicationController, ExecutionOrchestratorç­‰ï¼‰ |
| MultiPlcConfigManager | âœ… | Singleton | ApplicationController.ExecuteStep1InitializationAsync() |

#### Serviceså±¤
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|--------|-------------|-------------|
| AndonHostedService | âœ… | Hosted Service | .NET Generic Hostï¼ˆè‡ªå‹•ï¼‰ |
| TimerService | âœ… | Transient | ExecutionOrchestrator.RunContinuousDataCycleAsync() |

#### Infrastructureå±¤
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|--------|-------------|-------------|
| ConfigurationLoaderExcel | âœ… | Singleton | ApplicationController.ExecuteStep1InitializationAsync() |

---

### 2ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ãªã— âš ï¸ (å®Ÿè£…æ¸ˆã¿ã ãŒæœªçµ±åˆ)

#### Managerså±¤
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | å‚™è€ƒ |
|--------|--------|-------------|------|
| ErrorHandler | âœ… | Singleton | AsyncExceptionHandlerã«æ³¨å…¥ã•ã‚Œã‚‹ãŒæœªä½¿ç”¨ |
| ResourceManager | âœ… | Singleton | ãƒ¡ãƒ¢ãƒªç›£è¦–æ©Ÿèƒ½æœªå®Ÿè£… |
| MultiPlcCoordinator | âœ… | Singleton | ä¸¦åˆ—å®Ÿè¡Œåˆ¶å¾¡ã€ç¾åœ¨ã®ãƒ•ãƒ­ãƒ¼ã§ã¯æœªä½¿ç”¨ |

#### Serviceså±¤ - Phase3å®Ÿè£…ã‚¯ãƒ©ã‚¹
| ã‚¯ãƒ©ã‚¹ | DIç™»éŒ² | ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ  | å‚™è€ƒ |
|--------|--------|-------------|------|
| AsyncExceptionHandler | âœ… | Singleton | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |
| CancellationCoordinator | âœ… | Singleton | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |
| ResourceSemaphoreManager | âœ… | Singleton | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |
| GracefulShutdownHandler | âœ… | Singleton | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |
| ProgressReporter | âœ… | Transient | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |
| ParallelExecutionController | âœ… | Transient | Phase3å®Ÿè£…ã€ãƒ†ã‚¹ãƒˆã®ã¿ |

---

### 3ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š âœ… (é™çš„ã‚¯ãƒ©ã‚¹/ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£)

#### Serviceså±¤
| ã‚¯ãƒ©ã‚¹ | ç¨®åˆ¥ | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|------|-------------|
| DependencyInjectionConfigurator | é™çš„ã‚¯ãƒ©ã‚¹ | Program.CreateHostBuilder() |

#### Utilitieså±¤
| ã‚¯ãƒ©ã‚¹ | ç¨®åˆ¥ | æœ¬ç•ªåˆ©ç”¨ç®‡æ‰€ |
|--------|------|-------------|
| SlmpFrameBuilder | é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ | ConfigToFrameManager, ExecutionOrchestrator |
| BitExpansionUtility | é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ | PlcCommunicationManager |
| TerminalOutputHelper | é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ | PlcCommunicationManager, VerifyFix.cs |

---

### 4ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ãªã— âŒ (å®Œå…¨æœªä½¿ç”¨)

#### Serviceså±¤
| ã‚¯ãƒ©ã‚¹ | å‚™è€ƒ |
|--------|------|
| OptionsConfigurator | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |
| ServiceLifetimeManager | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |
| MultiConfigDIIntegration | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚ã‚Šï¼‰ |

#### Utilitieså±¤
| ã‚¯ãƒ©ã‚¹ | å‚™è€ƒ |
|--------|------|
| SlmpDataParser | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |
| DataConverter | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |
| DeviceAddressParser | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |
| HexStringFormatter | ã‚¯ãƒ©ã‚¹å®šç¾©ã®ã¿ |

---

## ğŸ“ˆ çµ±è¨ˆã‚µãƒãƒªãƒ¼

| åˆ†é¡ | ã‚¯ãƒ©ã‚¹æ•° | å‰²åˆ |
|------|---------|------|
| 1ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š | 12 | 32.4% |
| 2ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ãªã— | 9 | 24.3% |
| 3ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š | 4 | 10.8% |
| 4ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ãªã— | 7 | 18.9% |
| **ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆLoggingManagerå°‚ç”¨ãƒ­ã‚°ï¼‰** | 6 | 16.2% |
| **åˆè¨ˆ** | 37 | 100% |

---

## ğŸ” è¿½åŠ æƒ…å ±ï¼šLoggingManagerå°‚ç”¨ãƒ­ã‚°ãƒ¡ã‚½ãƒƒãƒ‰

ã“ã‚Œã‚‰ã¯ã‚¯ãƒ©ã‚¹ã§ã¯ãªããƒ¡ã‚½ãƒƒãƒ‰ã®ãŸã‚ã€åˆ¥æ ã§è¨˜è¼‰ï¼š

| ãƒ¡ã‚½ãƒƒãƒ‰ | æ‰€å±ã‚¯ãƒ©ã‚¹ | ãƒ†ã‚¹ãƒˆ | æœ¬ç•ªåˆ©ç”¨ |
|---------|-----------|--------|---------|
| LogDataAcquisition() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |
| LogFrameSent() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |
| LogResponseReceived() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |
| LogPlcProcessStart() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |
| LogPlcProcessComplete() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |
| LogPlcCommunicationError() | LoggingManager (DIç™»éŒ²æ¸ˆã¿) | âœ… | âŒ |

**å‚™è€ƒ**: LoggingManagerã‚¯ãƒ©ã‚¹è‡ªä½“ã¯ã€Œ1ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Šã€ã ãŒã€å°‚ç”¨ãƒ­ã‚°ãƒ¡ã‚½ãƒƒãƒ‰ã¯æœ¬ç•ªã‚³ãƒ¼ãƒ‰æœªä½¿ç”¨ã€‚

---

## ğŸ’¡ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåˆ†é¡åˆ¥ï¼‰

### 1ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š
âœ… **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸è¦** - æ­£å¸¸ã«æ©Ÿèƒ½ä¸­

### 2ï¸âƒ£ DIç™»éŒ²ã‚ã‚Š Ã— æœ¬ç•ªåˆ©ç”¨ãªã—
âš ï¸ **è¦æ„æ€æ±ºå®š**:
- **ã‚ªãƒ—ã‚·ãƒ§ãƒ³A**: Phase3çµ±åˆã‚’é€²ã‚ã‚‹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ç­‰ã®å¼·åŒ–ï¼‰
- **ã‚ªãƒ—ã‚·ãƒ§ãƒ³B**: DIç™»éŒ²ã‚’å‰Šé™¤ã—ã€å°†æ¥å®Ÿè£…äºˆå®šã¨ã—ã¦ä¿æŒ
- **ã‚ªãƒ—ã‚·ãƒ§ãƒ³C**: å®Œå…¨ã«å‰Šé™¤

### 3ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ã‚ã‚Š
âœ… **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¸è¦** - é™çš„ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¨ã—ã¦æ­£å¸¸ã«æ©Ÿèƒ½ä¸­

### 4ï¸âƒ£ DIç™»éŒ²ãªã— Ã— æœ¬ç•ªåˆ©ç”¨ãªã—
âŒ **æ¨å¥¨**: ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã‚’æ±ºå®š
- å°†æ¥å®Ÿè£…äºˆå®šã¨ã—ã¦ä¿æŒï¼ˆæ–‡æ›¸åŒ–å¿…è¦ï¼‰
- å‰Šé™¤

### LoggingManagerå°‚ç”¨ãƒ­ã‚°ãƒ¡ã‚½ãƒƒãƒ‰
âš ï¸ **æ¨å¥¨**: Phase3çµ±åˆæ™‚ã«ä½¿ç”¨ã™ã‚‹ã‹ã€ä¸è¦ã§ã‚ã‚Œã°å‰Šé™¤ã‚’æ¤œè¨

---

## ğŸ“‹ è©³ç´°ãªå†…è¨³

### DIç™»éŒ²æ¸ˆã¿ã‚¯ãƒ©ã‚¹ä¸€è¦§ï¼ˆ21ã‚¯ãƒ©ã‚¹ï¼‰

**æœ¬ç•ªåˆ©ç”¨ã‚ã‚Šï¼ˆ12ã‚¯ãƒ©ã‚¹ï¼‰:**
1. ApplicationController
2. ExecutionOrchestrator
3. ConfigurationWatcher
4. ConfigToFrameManager
5. PlcCommunicationManager
6. DataOutputManager
7. LoggingManager
8. MultiPlcConfigManager
9. AndonHostedService
10. TimerService
11. ConfigurationLoaderExcel
12. DependencyInjectionConfiguratorï¼ˆé™çš„ã‚¯ãƒ©ã‚¹ï¼‰

**æœ¬ç•ªåˆ©ç”¨ãªã—ï¼ˆ9ã‚¯ãƒ©ã‚¹ï¼‰:**
1. ErrorHandler
2. ResourceManager
3. MultiPlcCoordinator
4. AsyncExceptionHandler
5. CancellationCoordinator
6. ResourceSemaphoreManager
7. GracefulShutdownHandler
8. ProgressReporter
9. ParallelExecutionController

### DIæœªç™»éŒ²ã‚¯ãƒ©ã‚¹ä¸€è¦§ï¼ˆ11ã‚¯ãƒ©ã‚¹ï¼‰

**æœ¬ç•ªåˆ©ç”¨ã‚ã‚Šï¼ˆ3ã‚¯ãƒ©ã‚¹ + 1é™çš„ã‚¯ãƒ©ã‚¹ï¼‰:**
1. SlmpFrameBuilder
2. BitExpansionUtility
3. TerminalOutputHelper
4. DependencyInjectionConfiguratorï¼ˆé™çš„ï¼‰

**æœ¬ç•ªåˆ©ç”¨ãªã—ï¼ˆ7ã‚¯ãƒ©ã‚¹ï¼‰:**
1. OptionsConfigurator
2. ServiceLifetimeManager
3. MultiConfigDIIntegration
4. SlmpDataParser
5. DataConverter
6. DeviceAddressParser
7. HexStringFormatter

---

**åˆè¨ˆ**: 37é …ç›®ï¼ˆ32ã‚¯ãƒ©ã‚¹ + å°‚ç”¨ãƒ­ã‚°ãƒ¡ã‚½ãƒƒãƒ‰6ã¤ï¼‰
