# テスト方針と全体概要

## テスト方針
- **TDD手法**を使用してテスト駆動開発を実施
- **単一ブロック毎**の機能をテスト→パス確認後に複合時の動作テスト
- **入力/出力の値が既知**のものを含める
- **Step3-6のブロック（PlcCommunicationManager）を優先**して実装・テスト
- メソッドレベルの粒度でテストを実施

## 実装優先順位
1. **PlcCommunicationManager** (Step3-6) - 最優先
2. **LoggingManager** (ログ機能)
3. **ErrorHandler** (エラーハンドリング)
4. **ResourceManager** (メモリ・リソース管理)
5. **ConfigToFrameManager** (Step1-2) - SplitDwordToWord分割処理含む
6. **DataOutputManager** (Step7) - 任意の場所/形式への出力対応

## 動作フロー対応関係

### Step1: 設定ファイル条件の読み込み
- 範囲：アプリケーション
- 動作：設定ファイル条件の読み込み
- 成功条件：
  - 設定ファイルに記載されている値を正確に取得できること
  - 必要な値が設定されていない場合はエラーを返すこと

### Step2: 通信フレームの構築
- 範囲：アプリケーション
- 動作：通信フレームの構築(DWordの場合は事前に分割処理ステップを入れる)
- 成功条件：
  - Step1で取得した値から正しい内容のフレームを生成できること
  - DWordの情報を読み取る場合は分割→フレーム作成のステップが正しく動作すること

### Step3: PLCへの接続処理
- 範囲：アプリケーション
- 動作：PLCへの接続処理
- 成功条件：
  - 読み込んだ設定ファイルの情報から意図した機器に接続処理ができる
  - 接続に失敗した場合はエラーを返すこと

### Step4: PLCにリクエストを送信/レスポンス受信
- 範囲：アプリケーション/PLC
- 動作：PLCにリクエストを送信/リクエスト情報に従ってレスポンスを受信
  - 一度の通信で全ての機器からデータを取得(既定値 M001-M999,D001-D999)
- 成功条件：
  - 設定ファイルで指定した機器に対するリクエスト送信/レスポンス受信ができる

### Step5: 接続切断処理
- 範囲：アプリケーション
- 動作：接続切断処理
- 成功条件：
  - 正常に接続切断処理が完了できる

### Step6: 受信データ解析
- 範囲：アプリケーション
- 動作：受信データ解析(DWordの場合は事前に結合処理ステップを入れる)
- 成功条件：
  - PLCから受信したデータ(16進数)から正しい内容の構造化データに変換できること
  - DWordの情報を読み取る場合は受信データの結合→構造化データ変換のステップが正しく動作すること

### Step7: 解析後データの出力
- 範囲：アプリケーション
- 動作：解析後データの出力
- 成功条件：
  - 解析したデータを任意の場所/形式に出力/保存できる

## 実行パターン

### 基本実行フロー
- 初期化フェーズ（1回実行）: Step1
- データ処理サイクル（繰り返し実行）: Step2-7

### 継続実行モード
- 範囲：アプリケーション
- 動作：Step1で作成したインスタンスを使用して、Step2-7を周期的に繰り返し実行
- 実行順序：
  1. Step1（初期設定・インスタンス作成） - アプリケーション起動時に1回のみ実行
  2. Step2-7（データ処理サイクル） - MonitoringIntervalMs間隔で繰り返し実行
- 制御設定：
  - MonitoringIntervalMs: データ収集周期
  - ContinuousDataMode: 継続データモード有効化
- 成功条件：
  - Step1で作成したインスタンスが各サイクルで正常に動作すること
  - MonitoringIntervalMs間隔での安定した周期実行ができること
  - エラー発生時も継続実行が維持されること
  - データ破損等の一時的な異常でもアプリケーション停止せず次サイクルで回復すること

## テスト統計

**総テストケース数: 254個**

### テストケース内訳
- ConfigToFrameManager (Step1-2): TC001-TC016 (16個)
- PlcCommunicationManager (Step3-6): TC017-TC041 (25個) ★最優先
- LoggingManager: TC042-TC060 (19個)
- ErrorHandler: TC061-TC087 (27個)
- ResourceManager: TC088-TC094 (7個)
- DataOutputManager (Step7): TC095-TC099 (5個)
- インターフェース設計テスタビリティ: TC100-TC116 (17個)
- Modelsクラス単体テスト: TC117-TC141 (25個)
- 複合テスト設計: TC142-TC144 (3個) ★最重要
- パフォーマンステスト: TC145-TC146 (2個) ★最重要
- ApplicationController・ExecutionOrchestrator: TC150-TC168 (19個)
- 非同期・並行処理アーキテクチャ: TC169-TC181 (13個)
- DIコンテナ設計: TC182-TC192 (11個)
- Program.cs・エントリーポイント: TC193-TC209 (17個)
- その他詳細メソッドテスト: +48個
