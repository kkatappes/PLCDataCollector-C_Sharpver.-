# クラス・メソッド完全一覧表

## Phase1 (優先度★★★★★): Step3-6自動実行最小構成

### PlcCommunicationManager (Core/Communication/)
**Step3: PLC接続処理**
- ConnectAsync(): PLC接続処理
  - Input: ConnectionConfig, TimeoutConfig
  - Output: ConnectionResponse (Status, Socket, RemoteEndPoint, ConnectedAt, ConnectionTime, ErrorMessage)
  - 機能: TCP/UDP接続確立、UDP疎通確認（TC021フレーム使用）、ソケットタイムアウト設定

**Step4: PLCリクエスト送受信**
- SendFrameAsync(): PLCへのリクエスト送信
  - Input: SLMPフレーム（16進数文字列）
  - Output: Task (送信完了状態)
  - 機能: READコマンド(0104)送信、タイムアウト制御（Socket.SendTimeout使用）

- ReceiveResponseAsync(): PLCからのデータ受信
  - Input: なし（タイムアウトはConnectAsync内で設定済み）
  - Output: 生データ（16進数）、READコマンドレスポンス
  - 機能: SLMPレスポンス受信、タイムアウト制御（Socket.ReceiveTimeout使用）

**Step5: PLC切断処理**
- DisconnectAsync(): PLC切断処理（非同期版）
  - Input: 接続状態、通信統計情報
  - Output: ConnectionStats（通信統計情報）
  - 機能: 統計情報収集（接続時間、送受信数、応答時間、エラー統計）、適切なリソース解放

- Disconnect(): PLC切断処理（同期版）
  - Input: なし（内部状態使用）
  - Output: void
  - 機能: Socket.Shutdown()、Socket.Close()、Socket.Dispose()、内部状態初期化

- Dispose(): IDisposable実装
  - Input: なし
  - Output: void
  - 機能: 標準.NETリソース管理パターン、Disconnect()呼び出し、GC.SuppressFinalize()

**Step6: 受信データ解析（3段階処理）**
- ProcessReceivedRawData(): 受信データ基本後処理（Step6-1）
  - Input: 生データ（16進数）、ProcessedDeviceRequestInfo（送信時前処理情報）
  - Output: BasicProcessedResponseData（基本後処理結果）
  - 機能: 16進数パース、デバイス別データ抽出、基本型変換（ビット/ワード）、エラー検証

- CombineDwordData(): DWord結合処理（Step6-2）
  - Input: BasicProcessedResponseData、ProcessedDeviceRequestInfo（DWord分割情報）
  - Output: ProcessedResponseData（最終処理結果、DWord結合済み）
  - 機能: DWord分割要否判定、Low/Highワード結合、結合統計計算

- ParseRawToStructuredData(): 構造化データ変換（Step6-3）
  - Input: ProcessedResponseData（DWord結合済み）
  - Output: StructuredData（SLMP構造化解析結果）
  - 機能: SLMPヘッダー解析、終了コード解釈、デバイスデータ構造化

### ApplicationController (Core/Orchestration/)
- StartAsync(): アプリケーション開始処理
  - Input: CancellationToken
  - Output: Task
  - 機能: Step1初期化実行、Step2-7継続実行開始

### ExecutionOrchestrator (Core/Orchestration/)
- ExecuteSingleCycleAsync(): 単一サイクル実行
  - Input: ConfigToFrameManager, PlcCommunicationManager, DataOutputManager, LoggingManager
  - Output: CycleExecutionResult
  - 機能: Step2→Step3→Step4→Step5→Step6→Step7の順次実行

### TimerService (Infrastructure/Timing/)
- StartPeriodicExecution(): 定期実行開始
  - Input: Func<Task>（実行処理）、TimeSpan（実行間隔）、CancellationToken
  - Output: Task
  - 機能: System.Threading.PeriodicTimer使用、指定間隔での正確な実行制御

### LoggingManager (基本版) (Infrastructure/Logging/)
- LogCommunicationAsync(): 通信データ基本ログ出力（Phase1基本版）
  - Input: 送受信フレーム、通信統計
  - Output: Task
  - 機能: 基本通信ログ出力（Phase4で拡張）

---

## データ転送オブジェクト (Phase1)

### ConnectionStatus（列挙型）
- Connected: 接続成功
- Failed: 接続失敗
- Timeout: 接続タイムアウト

### ConnectionResponse（PlcCommunicationManager.ConnectAsync戻り値）
- Status（ConnectionStatus型、必須）: 接続状態
- Socket（Socket型、null許容）: 通信用ソケット（成功時のみ）
- RemoteEndPoint（EndPoint型、null許容）: 接続先情報（成功時のみ）
- ConnectedAt（DateTime型、null許容）: 接続完了時刻（成功時のみ）
- ConnectionTime（TimeSpan型、null許容）: 接続処理時間（成功時のみ）
- ErrorMessage（string型、null許容）: エラーメッセージ（失敗時のみ）

### ConnectionStats（PlcCommunicationManager.DisconnectAsync戻り値）
**基本通信統計**
- TotalConnectionTime（TimeSpan型、必須）: 総接続時間
- TotalFramesSent（int型、必須）: 送信フレーム総数
- TotalFramesReceived（int型、必須）: 受信フレーム総数
- TotalBytesSent（long型、必須）: 送信バイト総数
- TotalBytesReceived（long型、必須）: 受信バイト総数
- DisconnectedAt（DateTime型、必須）: 切断時刻

**応答時間統計**
- ResponseTimes（List<TimeSpan>型、必須）: 応答時間履歴
- AverageResponseTime（TimeSpan型、必須）: 平均応答時間（自動計算）
- MaxResponseTime（TimeSpan型、必須）: 最大応答時間（自動計算）
- MinResponseTime（TimeSpan型、必須）: 最小応答時間（自動計算）

**エラー・品質統計**
- TotalErrors（int型、必須）: エラー発生回数
- TotalRetries（int型、必須）: リトライ実行回数
- SuccessRate（double型、必須）: 通信成功率（0.0-1.0、自動計算）

**メソッド**
- AddResponseTime(TimeSpan): 応答時間追加・統計再計算
- IncrementError(): エラー発生時統計更新
- IncrementRetry(): リトライ実行時統計更新

### BasicProcessedResponseData（PlcCommunicationManager.ProcessReceivedRawData戻り値）
**基本処理結果**
- OriginalRawData（string型、必須）: 元の受信生データ（16進数）
- BasicProcessedData（Dictionary<string, object>型、必須）: 基本処理済みデータ（デバイス名キー）
- OriginalRequest（ProcessedDeviceRequestInfo型、必須）: 元のリクエスト情報
- ProcessedAt（DateTime型、必須）: 基本後処理実行時刻

**エラー情報**
- HasErrors（bool型、必須）: エラー発生フラグ
- Errors（List<string>型、必須）: エラーメッセージリスト
- Warnings（List<string>型、必須）: 警告メッセージリスト

**統計情報（自動計算）**
- ProcessedDeviceCount（int型、必須）: 処理されたデバイス数

**メソッド**
- AddBasicProcessedDevice(string, object, string): 基本デバイスデータ追加
- AddError(string): エラーメッセージ追加
- AddWarning(string): 警告メッセージ追加
- GetDeviceValue(string): 指定デバイスの値取得
- GetDeviceType(string): 指定デバイスのデータ型取得
- GetAllDeviceNames(): 全デバイス名取得

### ProcessedResponseData（PlcCommunicationManager.CombineDwordData戻り値）
**基本処理結果**
- OriginalRawData（string型、必須）: 元の受信生データ（16進数）
- ProcessedData（Dictionary<string, object>型、必須）: 後処理済みデータ（DWord結合済み）
- IsDwordCombined（bool型、必須）: DWord結合処理実行フラグ
- OriginalRequest（ProcessedDeviceRequestInfo型、必須）: 元のリクエスト情報
- ProcessedAt（DateTime型、必須）: 後処理実行時刻

**エラー情報**
- HasErrors（bool型、必須）: エラー発生フラグ
- Errors（List<string>型、必須）: エラーメッセージリスト
- Warnings（List<string>型、必須）: 警告メッセージリスト

**統計情報（自動計算）**
- ProcessedDeviceCount（int型、必須）: 処理されたデバイス数
- DWordCombinedCount（int型、必須）: DWord結合されたデバイス数

**メソッド**
- AddProcessedDevice(string, object, string, bool): デバイスデータ追加（DWord結合フラグ付き）
- AddError(string): エラーメッセージ追加
- AddWarning(string): 警告メッセージ追加
- MergeFromBasicData(BasicProcessedResponseData): 基本データからの統合
- GetDeviceValue(string): 指定デバイスの値取得
- GetDeviceType(string): 指定デバイスのデータ型取得
- GetCombinedDWordDevices(): DWord結合デバイス一覧取得
- GetNonCombinedDevices(): 結合対象外デバイス一覧取得

### SlmpHeader（SLMPヘッダー情報専用クラス）
**標準SLMP情報**
- SubHeader（string型、必須）: サブヘッダー（通信形式識別、例："5400"）
- NetworkNumber（string型、必須）: ネットワーク番号（例："01"）
- StationNumber（string型、必須）: 局番号（例："00"）
- ModuleIONumber（string型、必須）: モジュールI/O番号（例："03FF"）
- MultidropNumber（string型、必須）: マルチドロップ局番号（例："00"）
- RequestDataLength（string型、必須）: 要求データ長（例："001B"）

**解析情報**
- ParsedAt（DateTime型、必須）: ヘッダー解析時刻
- FrameType（string型、必須）: フレームタイプ（"3E" or "4E"）
- IsBinary（bool型、必須）: バイナリ形式フラグ

### StructuredData（PlcCommunicationManager.ParseRawToStructuredData戻り値）
**基本構造化データ**
- Header（SlmpHeader型、必須）: SLMPヘッダー情報（全標準情報含む）
- EndCode（string型、必須）: 終了コード（正常:"0000"、エラー:エラーコード）
- DeviceData（Dictionary<string, object>型、必須）: デバイスデータ
- ReceivedAt（DateTime型、必須）: 受信時刻
- IsError（bool型、必須）: エラー応答フラグ
- ErrorMessage（string型、null許容）: エラーメッセージ（エラー時のみ）

**解析詳細情報**
- SourceData（ProcessedResponseData型、必須）: 元の後処理データ
- ParseSteps（List<string>型、必須）: 解析手順の記録
- InterpretationInfo（Dictionary<string, string>型、必須）: 解釈情報
- ParsingTime（TimeSpan型、必須）: 解析にかかった時間
- TotalDevices（int型、必須）: 解析されたデバイス総数
- DeviceInterpretations（Dictionary<string, object>型、必須）: 人間が読める形式
- StatusJudgments（Dictionary<string, string>型、必須）: ON/OFF、正常/異常判定

**エラー詳細情報（null許容）**
- DetailedErrorCode（string型、null許容）: 詳細エラーコード（エラー時のみ）
- ErrorDescription（string型、null許容）: エラーの説明（エラー時のみ）
- AffectedDevices（List<string>型、null許容）: 影響を受けたデバイス（エラー時のみ）
- ErrorDetails（Dictionary<string, object>型、null許容）: エラーの詳細情報（エラー時のみ）

**メソッド**
- AddStructuredDevice(string, object, string, bool): 構造化デバイスデータ追加
- AddParseStep(string): 解析手順追加
- AddDeviceInterpretation(string, object): デバイス解釈情報追加
- AddStatusJudgment(string, string): ステータス判定追加
- SetErrorDetails(string, string, List<string>, Dictionary<string, object>): エラー詳細設定
- GetDeviceValue(string): 指定デバイスの値取得
- GetDeviceInterpretation(string): 指定デバイスの解釈情報取得
- GetStatusJudgment(string): 指定デバイスのステータス判定取得
- GetAllDeviceNames(): 全デバイス名取得
- GetErrorDevices(): エラー発生デバイス一覧取得

---

## Phase2 (優先度★★★★☆): 完全設定管理・DWord処理

### ConfigToFrameManager (Core/Configuration/)
- SplitDwordToWord(): DWord分割処理（基本実装）
  - Input: TargetDeviceConfig（MDeviceRange, DDeviceRange, DataType）
  - Output: ProcessedDeviceRequestInfo（機器種別判定済み、必要時のみDWord分割実行）
  - 機能: 機器種別判定（SLMP仕様書page_36.png準拠）、DataType別処理（Word/DWord/Mixed）

### ApplicationController (拡張) (Core/Orchestration/)
- StopAsync(): アプリケーション停止処理
  - Input: CancellationToken
  - Output: Task
  - 機能: 実行中サイクル適切停止、各Managerリソース解放、PLC接続適切切断

- ExecuteStep1InitializationAsync(): Step1初期化フェーズ実行
  - Input: 設定ディレクトリパス（string型、デフォルト："./config/"）
  - Output: InitializationResult
  - 機能: 複数設定ファイル読み込み、各種Managerインスタンス作成、初期化検証

- StartContinuousDataCycleAsync(): Step2-7継続実行開始
  - Input: InitializationResult、CancellationToken
  - Output: Task
  - 機能: ExecutionOrchestratorインスタンス作成、複数PLC並行実行開始（Task.WhenAll使用）

### ExecutionOrchestrator (拡張) (Core/Orchestration/)
- RunContinuousDataCycleAsync(): 継続データサイクル実行
  - Input: ConfigToFrameManager、PlcIdentifier（string型）、CancellationToken
  - Output: Task
  - 機能: TimerService使用によるMonitoringIntervalMs間隔制御、ExecuteSingleCycleAsync()繰り返し実行

- GetMonitoringInterval(): 監視間隔取得
  - Input: ConfigToFrameManager
  - Output: TimeSpan
  - 機能: MonitoringIntervalMs設定値をTimeSpanに変換

---

## データ転送オブジェクト (Phase2)

### InitializationResult（ApplicationController.ExecuteStep1InitializationAsync戻り値）
- LoadedConfigCount（int型、必須）: 読み込み成功した設定ファイル数
- CreatedManagersCount（int型、必須）: 作成されたManagerインスタンス数
- InitializationTime（TimeSpan型、必須）: 初期化処理にかかった時間
- IsSuccess（bool型、必須）: 初期化成功フラグ
- ErrorDetails（string型、null許容）: 初期化エラー詳細（失敗時のみ）
- LoadedConfigPaths（List<string>型、必須）: 読み込み成功した設定ファイルパス一覧
- FailedConfigs（Dictionary<string, string>型、必須）: 失敗した設定ファイルとエラー内容

### CycleExecutionResult（ExecutionOrchestrator.ExecuteSingleCycleAsync戻り値）
- IsSuccess（bool型、必須）: サイクル実行成功フラグ
- ExecutedSteps（List<string>型、必須）: 実行完了したステップ一覧
- ExecutionTime（TimeSpan型、必須）: サイクル全体の実行時間
- DataCount（int型、必須）: 処理されたデバイスデータ数
- PlcIdentifier（string型、必須）: 対象PLCの識別子
- ErrorDetails（string型、null許容）: エラー詳細（失敗時のみ）
- StepResults（Dictionary<string, object>型、必須）: 各ステップの実行結果詳細
- WarningMessages（List<string>型、必須）: 警告メッセージ一覧

**メソッド**
- AddStepResult(string stepName, object result): ステップ結果追加
- AddWarning(string message): 警告メッセージ追加
- GetStepResult<T>(string stepName): 指定ステップ結果取得

### ProcessedDeviceRequestInfo（ConfigToFrameManager.SplitDwordToWord戻り値）
- SplitRanges（Dictionary<string, List<string>>型、必須）: 機器種別判定・必要時のみ分割済み範囲情報
- DataTypeInfo（Dictionary<string, string>型、必須）: デバイス範囲別データ型情報
- OptimizedRanges（Dictionary<string, string>型、必須）: 最適化済み範囲情報
- DeviceTypeClassification（Dictionary<string, string>型、必須）: 機器種別分類情報

**メソッド（範囲操作）**
- AddSplitRange(string, List<string>): 分割範囲追加
- AddDataTypeInfo(string, string): データ型情報追加
- AddOptimizedRange(string, string): 最適化範囲追加
- AddDeviceTypeClassification(string, string): 機器種別分類追加

**メソッド（情報取得）**
- GetSplitRanges(string): 指定範囲の分割情報取得
- GetDataType(string): 指定範囲のデータ型取得
- GetDeviceTypeClassification(string): 指定範囲の機器種別取得
- GetAllDeviceTypes(): 全データ型一覧取得
- GetBitDevices(): ビット機器一覧取得
- GetWordDevices(): ワード機器一覧取得
- IsSplitRequired(string): 指定範囲の分割要否判定

---

## Phase3 (優先度★★★★☆): Step1-2完全実装

### ConfigToFrameManager (完全実装) (Core/Configuration/)
- LoadConfigAsync(): 設定ファイル読み込み（Step1: 単一設定ファイル読み込み）
  - Input: configFileName（string型、デフォルト："appsettings.xlsx"）
  - Output: ConnectionConfig, TimeoutConfig, TargetDeviceConfig, MonitoringIntervalMs, SystemResourcesConfig, DataProcessingConfig, LoggingConfig, DataTransferConfig, ActualConfigPath
  - 機能: 外部設定ファイル（appsettings.xlsx, UTF-8）読み込み、パス解決（./config/→./→環境変数）

- SplitDwordToWord(): DWord分割処理（完全実装）
  - 機能: Phase2基本実装に加え、全機器種別対応（M, X, Y, L, F, V, B, TS, TC, D, W, SD, TN）、詳細エラーハンドリング

- BuildFrames(): フレーム構築（Step2-2: 通信フレーム構築・機器種別対応）
  - Input: ConnectionConfig、ProcessedDeviceRequestInfo
  - Output: SLMPフレーム（16進数文字列、機器種別対応最適化済み）
  - 機能: READコマンド(0104)フレーム生成、3E/4Eフレーム対応、ASCII/バイナリ変換、機器種別に応じた適切なデータ長設定

- GetConfig<T>(): 設定取得（単一インスタンス用）
  - Input: 設定タイプ指定（ジェネリック型パラメータT）
  - Output: 指定設定オブジェクト
  - 機能: LoadConfigAsync/共有データから設定取得

### MultiConfigManager (Core/Configuration/)
- LoadAllFromDirectoryAsync(): 複数設定ファイル一括読み込み
  - Input: configDirectory（string型、デフォルト："./config/"）、filePattern（string型、デフォルト："*_settings.xlsx"）、allowPartialSuccess（bool型、デフォルト：true）
  - Output: Dictionary<string, ConfigToFrameManager>、LoadResult
  - 機能: 指定ディレクトリ内の複数設定ファイル読み込み、静的共有領域保存、軽量インスタンス生成

- CreateManagersAsync(): 軽量インスタンス生成
  - Input: configFileNames（string[]型）
  - Output: ConfigToFrameManager[]
  - 機能: 共有データを参照する軽量インスタンス生成

- GetSharedConfigData(): 共有データアクセス
  - Input: configFileName（string型）
  - Output: ConfigDataSet
  - 機能: 静的共有領域から指定ファイルの設定データ取得

- ReleaseSharedData(): 共有データ解放
  - Input: configFileName（string型、オプション）
  - Output: ReleasedMemoryKB
  - 機能: 明示的なメモリ解放（長時間稼働時の最適化）

### ErrorMessages (定数クラス) (Infrastructure/Errors/)
**機能概要**: 全システムで使用するエラーメッセージの一元管理、国際化対応基盤、メッセージ品質統一

**設定ファイル関連メッセージ**
- CONFIG_FILE_NOT_FOUND: "設定ファイルが見つかりません: {0}"
- CONFIG_DIRECTORY_NOT_FOUND: "設定ディレクトリが見つかりません: {0}"
- CONFIG_FILE_INVALID_FORMAT: "設定ファイルの形式が不正です: {0}"
- CONFIG_MISSING_REQUIRED_FIELD: "必須設定項目が不足しています: {0}"

**複数設定ファイル関連メッセージ**
- MULTI_CONFIG_LOAD_FAILED: "複数設定ファイル読み込みに失敗しました。成功: {0}件、失敗: {1}件"
- MULTI_CONFIG_PARTIAL_SUCCESS: "一部の設定ファイル読み込みに失敗しました: {0}"
- MULTI_CONFIG_NO_FILES_FOUND: "指定パターンに一致する設定ファイルが見つかりません: {0}"

**通信関連メッセージ**
- CONNECTION_FAILED: "PLC接続に失敗しました: {0}:{1}"
- CONNECTION_TIMEOUT: "PLC接続がタイムアウトしました: {0}ms"
- COMMUNICATION_ERROR: "PLC通信エラーが発生しました: {0}"
- FRAME_SEND_FAILED: "フレーム送信に失敗しました: {0}"
- RESPONSE_TIMEOUT: "応答受信がタイムアウトしました: {0}ms"

**権限・ファイルシステム関連メッセージ**
- FILE_ACCESS_DENIED: "ファイルアクセスが拒否されました: {0}"
- DIRECTORY_CREATE_FAILED: "ディレクトリ作成に失敗しました: {0}"
- WRITE_PERMISSION_CHECK_FAILED: "書き込み権限チェックに失敗しました: {0}"
- LOG_FILE_WRITE_FAILED: "ログファイル書き込みに失敗しました: {0}"

**メモリ・リソース関連メッセージ**
- MEMORY_LIMIT_EXCEEDED: "メモリ使用量が制限を超過しました: {0}KB/{1}KB"
- MEMORY_THRESHOLD_WARNING: "メモリ使用量が警告閾値を超過しました: {0}KB/{1}KB"
- RESOURCE_OPTIMIZATION_REQUIRED: "リソース最適化が必要です: {0}"

**汎用システムメッセージ**
- UNEXPECTED_ERROR: "予期しないエラーが発生しました: {0}"
- OPERATION_CANCELLED: "操作がキャンセルされました: {0}"
- INITIALIZATION_FAILED: "初期化に失敗しました: {0}"

### MultiConfigLoadException（複数設定ファイル専用例外）(Infrastructure/Errors/)
**機能概要**: 複数設定ファイル読み込み時の詳細なエラー情報保持、部分成功・失敗の状況管理

**プロパティ**
- LoadedFiles（List<string>型、必須）: 読み込み成功したファイル一覧
- FailedFiles（Dictionary<string, Exception>型、必須）: 失敗ファイルと対応する例外
- AttemptedDirectory（string型、必須）: 読み込み試行ディレクトリパス
- FilePattern（string型、必須）: 使用したファイルパターン（例："*_settings.xlsx"）
- TotalAttempted（int型、必須）: 読み込み試行総数（自動計算）
- SuccessCount（int型、必須）: 成功数（LoadedFiles.Count）
- FailureCount（int型、必須）: 失敗数（FailedFiles.Count）
- IsPartialSuccess（bool型、必須）: 部分成功フラグ（SuccessCount > 0 && FailureCount > 0）

**コンストラクタ**
- 完全失敗用: MultiConfigLoadException(string directory, string pattern, Dictionary<string, Exception> failures)
- 部分成功用: MultiConfigLoadException(string directory, string pattern, List<string> loaded, Dictionary<string, Exception> failures)
- 標準形式: MultiConfigLoadException(string message, Exception innerException)

**メソッド**
- GetDetailedErrorReport(): 詳細エラーレポート文字列生成
- GetFailedFileNames(): 失敗ファイル名一覧取得
- HasSpecificFailure(Type exceptionType): 特定例外タイプの失敗有無確認

---

## データ転送オブジェクト (Phase3)

### LoadResult（MultiConfigManager.LoadAllFromDirectoryAsync戻り値）
- LoadedFiles（List<string>型、必須）: 読み込み成功ファイル一覧
- FailedFiles（Dictionary<string, Exception>型、必須）: 失敗ファイルと例外
- TotalLoadTime（TimeSpan型、必須）: 総読み込み時間

---

## Phase4 (優先度★★★☆☆): インフラ完全版

### ResourceManager (Infrastructure/Resources/)
- GetMemoryUsage(): メモリ使用量取得
  - Input: システム状態（現在のメモリ使用状況）
  - Output: 現在のメモリ使用量（KB単位）、各コンポーネント別使用量
  - 機能: GC.GetTotalMemory()、Process.GetCurrentProcess().WorkingSet64等使用

- EvaluateLevel(): メモリレベル判定
  - Input: 現在メモリ使用量、閾値設定
  - Output: メモリレベル（Normal, Warning, Critical）、推奨アクション
  - 機能: 閾値比較、レベル判定、推奨アクション生成

- ApplyDataAndLoggingPolicy(): データ/ログポリシー適用
  - Input: メモリレベル、ポリシー設定
  - Output: 適用されたポリシー内容、データ処理制限設定
  - 機能: レベル別ポリシー適用、データ処理制限設定

- OptimizeMemory(): メモリ最適化実行
  - Input: 最適化対象（各クラスインスタンス）、最適化レベル
  - Output: 最適化実行結果、削減されたメモリ量
  - 機能: 各クラスメモリ解放、GC実行、削減量計算

- WriteLogAsync(): メモリ状況ログ出力
  - Input: メモリ使用状況、メモリレベル、最適化結果
  - Output: Task
  - 機能: メモリ状況ログ出力（LoggingManager.LogStateAsync()使用）

- RunMonitoringLoopAsync(): メモリ監視ループ実行
  - Input: 監視間隔設定、継続監視フラグ
  - Output: Task
  - 機能: 定期的メモリ監視、自動最適化実行

### LoggingManager (完全版) (Infrastructure/Logging/)
- InitializeAsync(): ログシステム初期化
  - Input: LoggingConfig（ConsoleOutput, DetailedLog設定）
  - Output: 初期化状態（ファイル作成等）
  - 機能: ログファイル初期化、出力先設定

- SetCorrelationId(): セッション関連付けID設定
  - Input: SessionId（処理セッション識別子）
  - Output: 関連付け設定完了状態
  - 機能: 関連ログのグループ化用ID設定

- SetLogLevel(): ログレベル設定
  - Input: LogLevel（出力レベル指定）
  - Output: レベル設定完了状態
  - 機能: ログ出力レベル動的変更

- IsLogLevelEnabled(): ログレベル有効性確認
  - Input: LogLevel（確認対象レベル）
  - Output: 有効性判定結果（true/false）
  - 機能: 指定レベルのログ出力有効性確認

- LogConfigAsync(): 設定情報詳細出力
  - Input: 全設定オブジェクト（ConnectionConfig, TimeoutConfig等）
  - Output: Task
  - 機能: 設定情報詳細ログ出力（ファイル、コンソール）

- LogCommunicationAsync(): 通信・送受信データ情報出力（Phase4拡張版）
  - Input: SLMPフレーム（送信/受信）、フレーム解析結果、通信統計
  - Output: Task
  - 機能: 生バイナリデータ出力（16進数ダンプ）、詳細SLMPフレーム解析出力（サブヘッダー、ネットワーク情報、終了コード詳細、データ部解析）

- LogStateAsync(): アプリケーション状態出力
  - Input: セッション情報、サイクル情報、処理状況
  - Output: Task
  - 機能: リアルタイム状態ログ出力

- LogMetricAsync(): 統計・パフォーマンス情報出力
  - Input: 実行統計、応答時間分析、システム稼働状況
  - Output: Task
  - 機能: パフォーマンス統計ログ出力

- LogErrorAsync(): エラー・例外情報詳細出力
  - Input: エラー分類、エラー詳細、回復処理結果
  - Output: Task
  - 機能: 詳細エラーログ出力（エラー分類、継続機能動作、リトライ処理、回復処理）

- LogDeviceDataAsync(): デバイス解釈情報出力
  - Input: 生データ、解釈結果、ステータス判定
  - Output: Task
  - 機能: デバイスデータ人間可読形式ログ出力

- BeginTransaction(): トランザクション開始
  - Input: TransactionId（トランザクション識別子）
  - Output: トランザクション開始状態
  - 機能: トランザクション単位ログ記録開始

- EndTransaction(): トランザクション終了
  - Input: TransactionId、TransactionResult（成功/失敗結果）
  - Output: トランザクション終了状態
  - 機能: トランザクション単位ログ記録終了

- FlushAsync(): バッファフラッシュ
  - Input: FlushTarget（ファイル指定）
  - Output: Task
  - 機能: ログバッファ強制フラッシュ

### ErrorHandler (完全版) (Infrastructure/Errors/)
- DetermineErrorCategory(): エラー分類判定
  - Input: Exception（発生したエラー・例外オブジェクト）、StepNumber（Step1-7のステップ番号）
  - Output: ErrorCategory（ConfigurationError, CommunicationError, DataProcessingError, ResourceError, SystemError）、Severity（Info, Warning, Error, Fatal）
  - 機能: 例外タイプ分析、ステップ別エラー分類

- RecordError(): エラー記録
  - Input: ErrorCategory、Severity、ErrorMessage、Exception、StepNumber
  - Output: 記録完了状態
  - 機能: エラー情報詳細記録、統計情報更新

- ApplyErrorPolicy(): エラー処理方針適用
  - Input: ErrorCategory、StepNumber
  - Output: ErrorAction（継続/終了の判定結果）
  - 機能: エラー分類・ステップ別処理方針決定

- ApplyRetryPolicy(): リトライ方針適用
  - Input: ErrorCategory、StepNumber、CurrentRetryCount
  - Output: ShouldRetry（リトライ判定）、MaxRetryCount（最大リトライ回数）
  - 機能: エラー分類・ステップ別リトライ判定

- GetErrorStatistics(): エラー統計取得（Phase4新規）
  - Input: なし（内部統計使用）
  - Output: ErrorStatistics（エラー統計情報）
  - 機能: 累積エラー統計情報取得

---

## データ転送オブジェクト (Phase4)

### MemoryLevel（列挙型）
- Normal: 正常レベル
- Warning: 警告レベル
- Critical: 危機的レベル

### ResourceType（列挙型）
- LogFile: ログファイルリソース
- ConfigFile: 設定ファイルリソース
- OutputFile: データ出力ファイルリソース

### ErrorCategory（列挙型）
- ConfigurationError: 設定エラー
- CommunicationError: 通信エラー
- DataProcessingError: データ処理エラー
- ResourceError: リソースエラー
- SystemError: システムエラー

### ErrorAction（列挙型）
- Continue: 継続
- Retry: リトライ
- Abort: 中断

---

## Phase5 (優先度★★☆☆☆): 非同期・並列処理

### AsyncExceptionHandler (Infrastructure/AsyncSupport/)
- HandleCriticalOperationAsync<T>(): 重要処理用例外ハンドリング
  - Input: Func<Task<T>>（実行対象の重要処理）、string（処理名称）、CancellationToken
  - Output: AsyncOperationResult<T>
  - 機能: 個別try-catch実行、詳細例外ログ出力、コンテキスト情報保持

- HandleGeneralOperationsAsync(): 一般処理用一括例外ハンドリング
  - Input: IEnumerable<Func<Task>>（実行対象の一般処理群）、string（処理グループ名称）、CancellationToken
  - Output: GeneralOperationResult
  - 機能: Task.WhenAll()での一括実行、失敗処理の継続実行、統合例外ログ出力

### CancellationCoordinator (Infrastructure/AsyncSupport/)
- CreateHierarchicalToken(): 階層キャンセレーショントークン作成
  - Input: CancellationToken（親トークン）、TimeSpan（タイムアウト時間、オプション）
  - Output: CancellationTokenSource（子トークンソース）
  - 機能: 親トークンとタイムアウトの組み合わせ、階層的キャンセル制御

- RegisterCancellationCallback(): キャンセル時コールバック登録
  - Input: CancellationToken（対象トークン）、Func<Task>（キャンセル時実行処理）、string（コールバック名称）
  - Output: CancellationTokenRegistration（登録ハンドル）
  - 機能: キャンセル時の適切な清掃処理登録、非同期コールバック対応

### ResourceSemaphoreManager (Infrastructure/AsyncSupport/)
**プロパティ**
- LogFileSemaphore（SemaphoreSlim型、必須）: ログファイル書き込み用セマフォ（同時アクセス数：1）
- ConfigFileSemaphore（SemaphoreSlim型、必須）: 設定ファイル読み込み用セマフォ（同時アクセス数：3）
- OutputFileSemaphore（SemaphoreSlim型、必須）: データ出力ファイル用セマフォ（同時アクセス数：2）

**メソッド**
- ExecuteWithSemaphoreAsync<T>(): セマフォ制御付き実行
  - Input: SemaphoreSlim（対象セマフォ）、Func<Task<T>>（実行対象処理）、CancellationToken、TimeSpan（セマフォ取得タイムアウト、デフォルト30秒）
  - Output: T（実行結果）
  - 機能: セマフォ取得→処理実行→セマフォ解放の確実実行、タイムアウト制御、例外発生時の確実なセマフォ解放

- GetResourceSemaphore(): リソース種別セマフォ取得
  - Input: ResourceType（リソース種別列挙型）
  - Output: SemaphoreSlim（対応するセマフォ）
  - 機能: リソース種別に応じたセマフォ取得

### ParallelExecutionController (Infrastructure/AsyncSupport/)
- ExecuteParallelPlcOperationsAsync(): 複数PLC並行実行
  - Input: IEnumerable<ConfigToFrameManager>（PLC用設定管理インスタンス群）、Func<ConfigToFrameManager, CancellationToken, Task<CycleExecutionResult>>（実行処理）、CancellationToken
  - Output: ParallelExecutionResult
  - 機能: Task.WhenAll()による真の並行実行、エラー発生PLC以外の継続実行制御、並行実行統計・監視情報取得

- MonitorParallelExecution(): 並行実行監視
  - Input: IEnumerable<Task<CycleExecutionResult>>（実行中タスク群）、IProgress<ParallelProgressInfo>（進捗レポーター）、CancellationToken
  - Output: Task
  - 機能: 実行中タスクの状態監視、完了・エラー・継続状況のリアルタイム報告、全体進捗率計算・表示

### ProgressReporter<T> (Infrastructure/AsyncSupport/)
- Report(): 進捗報告実行
  - Input: T（進捗情報：ProgressInfo型またはstring型）
  - Output: void
  - 機能: コンソール出力（リアルタイム表示）、ログファイル記録、進捗率計算・表示

- CreateStepProgress(): ステップ別進捗レポーター作成
  - Input: string（ステップ名）、int（予想処理数）
  - Output: ProgressReporter<ProgressInfo>
  - 機能: ステップ専用進捗レポーター生成

---

## データ転送オブジェクト (Phase5)

### AsyncOperationResult<T>（AsyncExceptionHandler.HandleCriticalOperationAsync戻り値）
- IsSuccess（bool型、必須）: 実行成功フラグ
- Result（T型、null許容）: 実行結果（成功時のみ）
- Exception（Exception型、null許容）: 発生例外（失敗時のみ）
- ExecutionTime（TimeSpan型、必須）: 実行時間
- OperationName（string型、必須）: 処理名称
- StartTime（DateTime型、必須）: 実行開始時刻
- EndTime（DateTime型、必須）: 実行終了時刻

### GeneralOperationResult（AsyncExceptionHandler.HandleGeneralOperationsAsync戻り値）
- SuccessCount（int型、必須）: 成功処理数
- FailureCount（int型、必須）: 失敗処理数
- TotalExecutionTime（TimeSpan型、必須）: 全体実行時間
- FailedOperations（List<string>型、必須）: 失敗した処理名一覧
- Exceptions（List<Exception>型、必須）: 発生例外一覧
- OperationGroupName（string型、必須）: 処理グループ名称
- ExecutedAt（DateTime型、必須）: 実行開始時刻

**メソッド**
- AddSuccess(string operationName): 成功処理追加
- AddFailure(string operationName, Exception exception): 失敗処理・例外追加
- GetSuccessRate(): 成功率計算（0.0-1.0）

### ParallelExecutionResult（ParallelExecutionController.ExecuteParallelPlcOperationsAsync戻り値）
- TotalPlcCount（int型、必須）: 対象PLC総数
- SuccessfulPlcCount（int型、必須）: 成功PLC数
- FailedPlcCount（int型、必須）: 失敗PLC数
- PlcResults（Dictionary<string, CycleExecutionResult>型、必須）: PLC別実行結果
- OverallExecutionTime（TimeSpan型、必須）: 全体実行時間
- ContinuingPlcIds（List<string>型、必須）: 継続実行中PLC ID一覧
- StartTime（DateTime型、必須）: 並行実行開始時刻
- CompletionTime（DateTime型、null許容）: 全PLC完了時刻（全完了時のみ）
- ParallelEfficiency（double型、必須）: 並行実行効率（0.0-1.0）

**メソッド**
- AddPlcResult(string plcId, CycleExecutionResult result): PLC結果追加
- UpdateContinuingPlcs(List<string> continuingIds): 継続PLC更新
- CalculateEfficiency(): 並行実行効率計算
- GetFailedPlcIds(): 失敗PLC ID一覧取得

### ProgressInfo（進捗報告用基底クラス）
- CurrentStep（string型、必須）: 現在実行ステップ
- Progress（double型、必須）: 進捗率（0.0-1.0）
- Message（string型、必須）: 進捗メッセージ
- EstimatedTimeRemaining（TimeSpan型、null許容）: 推定残り時間
- ElapsedTime（TimeSpan型、必須）: 経過時間
- ReportedAt（DateTime型、必須）: 報告時刻

### ParallelProgressInfo（並行実行進捗報告専用、ProgressInfo継承）
- ActivePlcCount（int型、必須）: 実行中PLC数
- CompletedPlcCount（int型、必須）: 完了PLC数
- FailedPlcCount（int型、必須）: 失敗PLC数
- PlcProgresses（Dictionary<string, double>型、必須）: PLC別進捗率
- OverallProgress（double型、必須）: 全体進捗率

**メソッド**
- UpdatePlcProgress(string plcId, double progress): PLC進捗更新
- CalculateOverallProgress(): 全体進捗率計算

---

## Phase6 (優先度★★☆☆☆): Host・DIシステム

### AndonHostedService (Infrastructure/Hosting/)
- ExecuteAsync(): バックグラウンド実行メイン処理
  - Input: CancellationToken（.NETランタイムから取得）
  - Output: Task
  - 機能: ApplicationController.StartAsync()実行、CancellationToken監視による適切な終了制御

- StartAsync(): HostedService開始処理
  - Input: CancellationToken（.NETランタイムから取得）
  - Output: Task
  - 機能: 起動ログ出力、ApplicationController初期化確認

- StopAsync(): HostedService停止処理
  - Input: CancellationToken（.NETランタイムから取得）
  - Output: Task
  - 機能: ApplicationController.StopAsync()実行、停止ログ出力

### DependencyInjectionConfigurator (Infrastructure/DI/)
- ConfigureServices(): サービス登録・設定
  - Input: IServiceCollection（DIコンテナ）、IConfiguration（設定情報）
  - Output: IServiceCollection（設定完了済みDIコンテナ）
  - 機能: 全主要クラスのインターフェース登録、ライフタイム設定（Singleton/Transient）、Optionsパターン設定値注入、HostedService登録

- RegisterCoreServices(): コアサービス登録
  - Input: IServiceCollection（DIコンテナ）
  - Output: IServiceCollection
  - 機能: ApplicationController→IApplicationController（Singleton）、ExecutionOrchestrator→IExecutionOrchestrator（Transient）、ConfigToFrameManager→IConfigToFrameManager（Transient）、PlcCommunicationManager→IPlcCommunicationManager（Transient）、DataOutputManager→IDataOutputManager（Singleton）

- RegisterInfrastructureServices(): インフラサービス登録
  - Input: IServiceCollection（DIコンテナ）
  - Output: IServiceCollection
  - 機能: LoggingManager→ILoggingManager（Singleton）、ErrorHandler→IErrorHandler（Singleton）、ResourceManager→IResourceManager（Singleton）、AsyncExceptionHandler→IAsyncExceptionHandler（Singleton）、ResourceSemaphoreManager→IResourceSemaphoreManager（Singleton）

- RegisterAsyncServices(): 非同期処理サービス登録
  - Input: IServiceCollection（DIコンテナ）
  - Output: IServiceCollection
  - 機能: CancellationCoordinator→ICancellationCoordinator（Singleton）、ParallelExecutionController→IParallelExecutionController（Singleton）、ProgressReporter<T>→IProgressReporter<T>（Transient）、TimerService→ITimerService（Transient）

- RegisterHostedServices(): HostedService登録
  - Input: IServiceCollection（DIコンテナ）
  - Output: IServiceCollection
  - 機能: AndonHostedService登録（IHostedService）、GracefulShutdownHandler登録

### OptionsConfigurator (Infrastructure/DI/)
- ConfigureOptions(): Options設定・注入
  - Input: IServiceCollection（DIコンテナ）、IConfiguration（設定情報）
  - Output: IServiceCollection
  - 機能: IOptions<ConnectionConfig>注入設定、IOptions<TimeoutConfig>注入設定、IOptions<SystemResourcesConfig>注入設定、IOptions<LoggingConfig>注入設定、バリデーション設定

- ValidateOptions(): 設定値バリデーション
  - Input: IServiceCollection（DIコンテナ）
  - Output: IServiceCollection
  - 機能: 必須項目チェック設定、範囲値チェック設定、形式チェック設定（IPアドレス、ポート番号等）

### ServiceLifetimeManager (Infrastructure/DI/)
- DetermineLifetime(): ライフタイム判定
  - Input: Type（対象クラス型）、ServiceRole（サービス役割）
  - Output: ServiceLifetime（Singleton, Scoped, Transient）
  - 機能: クラス特性分析、リソース使用パターン分析、最適ライフタイム判定

- ValidateLifetimeConsistency(): ライフタイム整合性検証
  - Input: IServiceCollection（DIコンテナ）
  - Output: ValidationResult
  - 機能: 依存関係ライフタイム検証、Singleton→Transient依存の警告、循環依存チェック

### Program (Infrastructure/Hosting/)
- Main(): アプリケーションエントリーポイント
  - Input: string[] args（コマンドライン引数）
  - Output: int（終了コード：0=正常、1=エラー、2=設定エラー、3=権限エラー）
  - 機能: コマンドライン引数解析、CreateHostBuilder()実行、Host.RunAsync()実行、最上位例外処理

- CreateHostBuilder(): Host構築
  - Input: string[] args（コマンドライン引数）
  - Output: IHostBuilder
  - 機能: Generic Host初期化、ConfigureServices()実行、ConfigureConfiguration()実行、ConfigureLogging()実行

- ConfigureServices(): サービス設定
  - Input: HostBuilderContext、IServiceCollection
  - Output: void
  - 機能: DependencyInjectionConfigurator.ConfigureServices()実行、OptionsConfigurator.ConfigureOptions()実行、AndonHostedService登録

- ConfigureConfiguration(): 設定統合
  - Input: HostBuilderContext、IConfigurationBuilder
  - Output: void
  - 機能: appsettings.json読み込み、環境変数読み込み、コマンドライン引数読み込み、設定優先順位設定

- ConfigureLogging(): ログ設定
  - Input: HostBuilderContext、ILoggingBuilder
  - Output: void
  - 機能: コンソールログ設定、ファイルログ設定、ログレベル設定、ログフォーマット設定

### CommandLineOptions (Infrastructure/Hosting/)
**プロパティ**
- ConfigDirectory（string型、null許容）: 設定ファイルディレクトリパス（--config-dir）
- LogLevel（string型、null許容）: ログレベル（--log-level）
- ConsoleOutput（bool型、必須）: コンソール出力有効性（--console、デフォルト：true）
- ShowVersion（bool型、必須）: バージョン表示フラグ（--version）
- ShowHelp（bool型、必須）: ヘルプ表示フラグ（--help）
- DryRun（bool型、必須）: ドライ実行フラグ（--dry-run、設定検証のみ）

**メソッド**
- Parse(): コマンドライン引数解析
  - Input: string[] args
  - Output: CommandLineOptions
  - 機能: 引数パターンマッチング、オプション値抽出、バリデーション実行

- Validate(): オプションバリデーション
  - Input: CommandLineOptions
  - Output: ValidationResult
  - 機能: 設定ディレクトリ存在チェック、ログレベル形式チェック、オプション組み合わせチェック

### ExitCodeManager (Infrastructure/Hosting/)
**列挙型（ExitCode）**
- Success: 正常終了（0）
- GeneralError: 一般エラー（1）
- ConfigurationError: 設定エラー（2）
- PermissionError: 権限エラー（3）
- NetworkError: ネットワークエラー（4）
- FileSystemError: ファイルシステムエラー（5）

**メソッド**
- DetermineExitCode(): 終了コード判定
  - Input: Exception（発生例外）
  - Output: ExitCode
  - 機能: 例外タイプ分析、エラーカテゴリ判定、終了コード決定

- LogExitInformation(): 終了情報ログ出力
  - Input: ExitCode（終了コード）、Exception（例外、null許容）、TimeSpan（実行時間）
  - Output: Task
  - 機能: 終了コード・理由ログ出力、実行時間・統計ログ出力、エラー詳細ログ出力（エラー時のみ）

---

## データ転送オブジェクト (Phase6)

### ExitCode（列挙型）
- 上記ExitCodeManager参照

---

## Phase7 (優先度★☆☆☆☆): 高度な機能

### GracefulShutdownHandler (Infrastructure/Hosting/)
- RegisterShutdownHandlers(): 終了ハンドラ登録
  - Input: ApplicationController（制御対象）、CancellationTokenSource（キャンセレーション制御）
  - Output: 登録完了状態
  - 機能: Console.CancelKeyPress登録、AppDomain.ProcessExit登録、キャンセレーショントークン発行

- ExecuteGracefulShutdown(): 適切な終了処理実行
  - Input: ApplicationController（制御対象）、TimeSpan（タイムアウト時間、デフォルト30秒）
  - Output: ShutdownResult
  - 機能: ApplicationController.StopAsync()実行、各Managerクラスのリソース解放確認、タイムアウト制御

### MultiConfigDIIntegration (Infrastructure/DI/)
- RegisterMultiConfigServices(): 複数設定対応サービス登録
  - Input: IServiceCollection（DIコンテナ）、MultiConfigManager（複数設定管理）
  - Output: IServiceCollection
  - 機能: 設定ファイル別ConfigToFrameManagerファクトリ登録、PLC別PlcCommunicationManagerファクトリ登録、軽量インスタンス生成器登録

- CreateConfigSpecificProvider(): 設定別サービスプロバイダ作成
  - Input: IServiceProvider（メインプロバイダ）、string（設定ファイル名）
  - Output: IServiceProvider（設定専用プロバイダ）
  - 機能: 設定ファイル専用スコープ作成、該当設定値の注入、軽量インスタンス解決

---

## データ転送オブジェクト (Phase7)

### ShutdownResult（GracefulShutdownHandler.ExecuteGracefulShutdown戻り値）
- IsGraceful（bool型、必須）: 適切な終了処理完了フラグ
- ShutdownTime（TimeSpan型、必須）: 終了処理にかかった時間
- CompletedTasks（List<string>型、必須）: 完了した終了タスク一覧
- IncompleteTaskCount（int型、必須）: 未完了タスク数
- IncompleteTaskDetails（List<string>型、必須）: 未完了タスク詳細一覧
- FinalResourceState（Dictionary<string, string>型、必須）: 最終リソース状態
- ShutdownTrigger（string型、必須）: 終了契機（例："Ctrl+C", "ProcessExit", "Manual"）

---

## Phase8 (優先度☆☆☆☆☆): Step7データ出力

### DataOutputManager (Core/Output/)
- OutputDataAsync(): 解析後データ出力
  - Input: StructuredData（構造化データ）、出力設定（FilePath, Format）
  - Output: Task
  - 機能: 解析したデータを任意の場所/形式に出力/保存

---

## 共通データ転送オブジェクト (全Phase共通)

### ConfigModels (Core/Models/ConfigModels/)

#### ConnectionType（列挙型）
- Ethernet: イーサネット接続（既定）
- Serial: シリアル接続
- USB: USB接続

#### FrameVersion（列挙型）
- Frame3E: 3Eフレーム
- Frame4E: 4Eフレーム（既定）

#### ConnectionConfig（PLC接続設定）
- IpAddress（IPAddress型、必須）: PLC接続先IPアドレス
- Port（int型、必須）: PLC接続ポート番号
- UseTcp（bool型、必須）: TCP/UDP選択フラグ（デフォルト：false = UDP優先）
- ConnectionType（ConnectionType型、必須）: 接続タイプ（デフォルト：Ethernet）
- IsBinary（bool型、必須）: バイナリ/ASCII形式選択（デフォルト：false = ASCII形式）
- FrameVersion（FrameVersion型、必須）: 3E/4Eフレーム選択（デフォルト：Frame4E）

#### TimeoutConfig（タイムアウト設定）
- ConnectTimeoutMs（int型、必須）: PLC接続タイムアウト（デフォルト：5000ms = 5秒）
- SendTimeoutMs（int型、必須）: データ送信タイムアウト（デフォルト：500ms = 0.5秒）
- ReceiveTimeoutMs（int型、必須）: データ受信タイムアウト（デフォルト：500ms = 0.5秒）
- RetryTimeoutMs（int型、必須）: エラー時リトライ間隔（デフォルト：1000ms = 1秒）

#### TargetDeviceConfig（対象デバイス設定）
- MDeviceRange（string型、必須）: Mデバイス範囲（ビット機器、デフォルト："M001-M999"）
- DDeviceRange（string型、必須）: Dデバイス範囲（ワード機器、デフォルト："D001-D999"）
- DataType（string型、必須）: データ型指定・分割処理制御（デフォルト："Mixed"）
  - "Word": ワード機器分割処理なし
  - "DWord": ワード機器DWord分割処理実行
  - "Mixed": Word/DWord混在対応

#### SystemResourcesConfig（システムリソース設定）
- MemoryLimitKB（int型、必須）: メモリ使用制限（デフォルト：102400KB = 100MB）
- MaxBufferSize（int型、必須）: 最大バッファサイズ（デフォルト：8192B = 8KB）
- MemoryThresholdKB（int型、必須）: メモリ警告閾値（デフォルト：81920KB = 80MB）
- LowMemoryMode（bool型、必須）: 低メモリモード（デフォルト：false = 無効）

#### DataProcessingConfig（データ処理設定）
- TargetName（string型、必須）: 処理対象名称（デフォルト："DefaultTarget"）
- ContinuousDataMode（bool型、必須）: 継続データモード（デフォルト：true = 有効）
- DataRetentionDays（int型、必須）: データ保持期間（デフォルト：30日）

#### LoggingConfig（ログ設定）
- ConsoleOutput（bool型、必須）: コンソール出力有効性（デフォルト：true = 有効）
- DetailedLog（bool型、必須）: 詳細ログ出力有効性（デフォルト：true = 有効）

#### DataTransferConfig（データ転送設定）
- EnableTransfer（bool型、必須）: データ転送機能有効性（デフォルト：false = 無効）
- DestinationIpAddress（string型、必須）: 転送先IPアドレス（デフォルト："" = 空文字）
- DestinationPort（int型、必須）: 転送先ポート番号（デフォルト：0 = 未指定）

---

## インターフェース一覧（テスタビリティ確保・TDD対応）

### Phase1 インターフェース
- **IPlcCommunicationManager**: PlcCommunicationManager契約（全メソッド）
- **IApplicationController**: ApplicationController契約（StartAsync）
- **IExecutionOrchestrator**: ExecutionOrchestrator契約（ExecuteSingleCycleAsync）
- **ITimerService**: TimerService契約（StartPeriodicExecution）

### Phase3 インターフェース
- **IConfigToFrameManager**: ConfigToFrameManager契約（全メソッド）
- **IMultiConfigManager**: MultiConfigManager契約（全メソッド）

### Phase4 インターフェース
- **IResourceManager**: ResourceManager契約（全メソッド）
- **ILoggingManager**: LoggingManager契約（全メソッド）
- **IErrorHandler**: ErrorHandler契約（全メソッド）

### Phase5 インターフェース
- **IAsyncExceptionHandler**: AsyncExceptionHandler契約（階層的例外ハンドリング）
- **ICancellationCoordinator**: CancellationCoordinator契約（キャンセレーション制御）
- **IResourceSemaphoreManager**: ResourceSemaphoreManager契約（共有リソース排他制御）
- **IParallelExecutionController**: ParallelExecutionController契約（並行実行制御）
- **IProgressReporter<T>**: ProgressReporter<T>契約（進捗報告）

### Phase6 インターフェース
- **IAndonHostedService**: AndonHostedService契約（HostedService）
- **IDependencyInjectionConfigurator**: DependencyInjectionConfigurator契約（DI設定）
- **IOptionsConfigurator**: OptionsConfigurator契約（Options設定）

### Phase7 インターフェース
- **IGracefulShutdownHandler**: GracefulShutdownHandler契約（適切な終了処理）
- **IMultiConfigDIIntegration**: MultiConfigDIIntegration契約（複数設定DI統合）
- **IConfigurationWatcher**: ConfigurationWatcher契約（設定ファイル変更監視、将来実装用）

### Phase8 インターフェース
- **IDataOutputManager**: DataOutputManager契約（データ出力）

---

## 実装順序サマリー

1. **Phase1 (★★★★★)**: Step3-6 PLC通信核心部（最優先）
   - PlcCommunicationManager完全実装（ConnectAsync～ParseRawToStructuredData）
   - 基本実行制御（ApplicationController, ExecutionOrchestrator, TimerService）
   - 3段階データ解析処理（ProcessReceivedRawData, CombineDwordData, ParseRawToStructuredData）
   - 全データ転送オブジェクト（ConnectionResponse, ConnectionStats, BasicProcessedResponseData, ProcessedResponseData, SlmpHeader, StructuredData）

2. **Phase2 (★★★★☆)**: 完全設定管理・DWord処理
   - ConfigToFrameManager基本実装（SplitDwordToWord基本版）
   - ApplicationController拡張（StopAsync, ExecuteStep1InitializationAsync, StartContinuousDataCycleAsync）
   - ExecutionOrchestrator拡張（RunContinuousDataCycleAsync, GetMonitoringInterval）
   - データ転送オブジェクト（InitializationResult, CycleExecutionResult, ProcessedDeviceRequestInfo）

3. **Phase3 (★★★★☆)**: Step1-2完全実装
   - ConfigToFrameManager完全実装（LoadConfigAsync, SplitDwordToWord完全版, BuildFrames, GetConfig<T>）
   - MultiConfigManager完全実装（全メソッド）
   - エラー管理（ErrorMessages定数クラス、MultiConfigLoadException）

4. **Phase4 (★★★☆☆)**: インフラ完全版
   - ResourceManager完全実装（メモリ・リソース管理）
   - LoggingManager完全版（全ログ機能）
   - ErrorHandler完全版（エラー分類・記録・ポリシー適用）

5. **Phase5 (★★☆☆☆)**: 非同期・並列処理
   - AsyncExceptionHandler（階層的例外ハンドリング）
   - CancellationCoordinator（キャンセレーション制御）
   - ResourceSemaphoreManager（共有リソース排他制御）
   - ParallelExecutionController（複数PLC並行実行）
   - ProgressReporter<T>（進捗報告）
   - 全データ転送オブジェクト（AsyncOperationResult<T>, GeneralOperationResult, ParallelExecutionResult, ProgressInfo, ParallelProgressInfo）

6. **Phase6 (★★☆☆☆)**: Host・DIシステム
   - AndonHostedService（.NET HostedService実装）
   - DependencyInjectionConfigurator（DI設定・サービス登録）
   - OptionsConfigurator（Options設定・バリデーション）
   - ServiceLifetimeManager（ライフタイム管理）
   - Program（エントリーポイント・Host構築）
   - CommandLineOptions（コマンドライン引数解析）
   - ExitCodeManager（終了コード管理）

7. **Phase7 (★☆☆☆☆)**: 高度な機能
   - GracefulShutdownHandler（適切な終了処理）
   - MultiConfigDIIntegration（複数設定DI統合）
   - ShutdownResult（終了結果）

8. **Phase8 (☆☆☆☆☆)**: Step7データ出力
   - DataOutputManager（データ出力機能）

---

## Phase別依存関係

- **Phase1**: 独立（最小構成）
- **Phase2**: Phase1に依存
- **Phase3**: Phase1, Phase2に依存
- **Phase4**: Phase1, Phase2, Phase3に依存
- **Phase5**: Phase1, Phase2に依存（Phase3, Phase4とは独立）
- **Phase6**: 全Phase統合（Phase1-5に依存）
- **Phase7**: Phase6に依存
- **Phase8**: Phase1, Phase4に依存

---

## TDD実装サイクル適用

**Red-Green-Refactorサイクル**
1. テストケース作成（TC001-TC051、テスト内容.md参照）
2. テスト実行（Red：失敗）
3. 最小限の実装（Green：成功）
4. リファクタリング（品質向上）
5. 実装記録作成（documents/implementation_records/method_records/）
6. 学習資料作成（documents/implementation_records/learning_materials/、各メソッドごと）

**単一ブロック毎のテスト原則**
- 単一ブロックでのテストパス前に、複合での機能テストは実施しない
- 必ず全ての単一ブロック毎の機能をテスト→パス確認後に、複合時の動作テストを行う

---

## 注意事項

1. **Phase1-3は核心機能のため優先度が高い**
   - Phase1: PLC通信の最小動作確認
   - Phase2: 設定管理・DWord処理の基本実装
   - Phase3: Step1-2完全実装・複数設定対応

2. **Phase4-6はインフラ・基盤機能**
   - Phase4: ログ・エラー・リソース管理の完全実装
   - Phase5: 非同期・並列処理の実装
   - Phase6: Host・DIシステムの実装

3. **Phase7-8は応用的機能**
   - Phase7: グレースフルシャットダウン等の高度な機能
   - Phase8: Step7データ出力

4. **各Phaseは前のPhaseの完了を前提とする**
   - 依存関係を明確にし、順次実装を進める
   - テストは各Phase完了時に実施

5. **データ転送オブジェクト（Models）の重要性**
   - 型安全性確保・null安全性管理
   - テスタビリティ向上
   - 各Phaseで使用するModelsを明確化

6. **インターフェース設計の重要性**
   - テスタビリティ確保・TDD手法サポート
   - モック・スタブ対応
   - 全主要クラスのインターフェース分離

---

## ファイル構造（推奨）

```
Andon/
├── Core/
│   ├── Communication/
│   │   └── PlcCommunicationManager.cs
│   ├── Configuration/
│   │   ├── ConfigToFrameManager.cs
│   │   └── MultiConfigManager.cs
│   ├── Orchestration/
│   │   ├── ApplicationController.cs
│   │   └── ExecutionOrchestrator.cs
│   ├── Output/
│   │   └── DataOutputManager.cs
│   └── Models/
│       ├── ConfigModels/ (ConnectionConfig, TimeoutConfig等)
│       ├── CommunicationModels/ (ConnectionResponse, ConnectionStats等)
│       └── AsyncModels/ (AsyncOperationResult等)
├── Infrastructure/
│   ├── Logging/
│   │   └── LoggingManager.cs
│   ├── Errors/
│   │   ├── ErrorHandler.cs
│   │   ├── ErrorMessages.cs
│   │   └── MultiConfigLoadException.cs
│   ├── Resources/
│   │   └── ResourceManager.cs
│   ├── AsyncSupport/
│   │   ├── AsyncExceptionHandler.cs
│   │   ├── CancellationCoordinator.cs
│   │   ├── ResourceSemaphoreManager.cs
│   │   ├── ParallelExecutionController.cs
│   │   └── ProgressReporter.cs
│   ├── Timing/
│   │   └── TimerService.cs
│   ├── DI/
│   │   ├── DependencyInjectionConfigurator.cs
│   │   ├── OptionsConfigurator.cs
│   │   ├── ServiceLifetimeManager.cs
│   │   └── MultiConfigDIIntegration.cs
│   └── Hosting/
│       ├── AndonHostedService.cs
│       ├── GracefulShutdownHandler.cs
│       ├── Program.cs
│       ├── CommandLineOptions.cs
│       └── ExitCodeManager.cs
├── Interfaces/
│   ├── IPlcCommunicationManager.cs
│   ├── IApplicationController.cs
│   ├── IConfigToFrameManager.cs
│   ├── ... (全インターフェース)
└── Tests/
    ├── PlcCommunicationManagerTests.cs
    ├── ConfigToFrameManagerTests.cs
    └── ... (全テストクラス)
```
