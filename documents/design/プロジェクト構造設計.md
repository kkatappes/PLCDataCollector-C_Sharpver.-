# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ è¨­è¨ˆ

## æ¦‚è¦
SLMPé€šä¿¡ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã«ãŠã‘ã‚‹ã€srcãƒ•ã‚©ãƒ«ãƒ€å†…ã®è©³ç´°ãªæ§‹é€ è¨­è¨ˆãŠã‚ˆã³Modelsã‚¯ãƒ©ã‚¹è¨­è¨ˆã®è¨˜éŒ²

## å®Ÿè£…å„ªå…ˆé †ä½
1. **PlcCommunicationManager** (Step3-6) - æœ€å„ªå…ˆ
2. **LoggingManager** (ãƒ­ã‚°æ©Ÿèƒ½)
3. **ErrorHandler** (ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°)
4. **ResourceManager** (ãƒ¡ãƒ¢ãƒªãƒ»ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†)
5. **ConfigToFrameManager** (Step1-2)
6. **DataOutputManager** (Step7)

---

## ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 

```
andon/
â”œâ”€â”€ Program.cs                           // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆãƒ»Hostæ§‹ç¯‰
â”œâ”€â”€ CommandLineOptions.cs               // ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°è§£æ
â”œâ”€â”€ ExitCodeManager.cs                  // çµ‚äº†ã‚³ãƒ¼ãƒ‰ç®¡ç†ãƒ»ã‚¨ãƒ©ãƒ¼åˆ†é¡
â”œâ”€â”€ Core/
â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”œâ”€â”€ ApplicationController.cs     // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“åˆ¶å¾¡ãƒ»ç¶™ç¶šå®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰
â”‚   â”‚   â”œâ”€â”€ ExecutionOrchestrator.cs     // Step2-7ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œåˆ¶å¾¡
â”‚   â”‚   â””â”€â”€ ConfigurationWatcher.cs      // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ç›£è¦–ãƒ»å‹•çš„å†èª­ã¿è¾¼ã¿
â”‚   â”œâ”€â”€ Managers/
â”‚   â”‚   â”œâ”€â”€ ConfigToFrameManager.cs      // Step1-2: è¨­å®šèª­ã¿è¾¼ã¿ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
â”‚   â”‚   â”‚                                // BuildReadRandomFrameFromConfig() - ReadRandom Binaryå½¢å¼
â”‚   â”‚   â”‚                                // BuildReadRandomFrameFromConfigAscii() - ReadRandom ASCIIå½¢å¼
â”‚   â”‚   â”œâ”€â”€ MultiConfigManager.cs        // è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ PlcCommunicationManager.cs   // Step3-6: PLCé€šä¿¡ãƒ»ãƒ‡ãƒ¼ã‚¿é€å—ä¿¡ (æœ€å„ªå…ˆ)
â”‚   â”‚   â”œâ”€â”€ MultiPlcCoordinator.cs       // è¤‡æ•°PLCä¸¦åˆ—å®Ÿè¡Œèª¿æ•´ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚   â”‚   â”œâ”€â”€ DataOutputManager.cs         // Step7: ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›
â”‚   â”‚   â”œâ”€â”€ LoggingManager.cs           // ãƒ­ã‚°æ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ ErrorHandler.cs             // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”‚   â””â”€â”€ ResourceManager.cs          // ãƒ¡ãƒ¢ãƒªãƒ»ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â”œâ”€â”€ ConnectionStatus.cs         // æ¥ç¶šçŠ¶æ…‹åˆ—æŒ™å‹
â”‚   â”‚   â”œâ”€â”€ ConnectionType.cs           // æ¥ç¶šã‚¿ã‚¤ãƒ—åˆ—æŒ™å‹
â”‚   â”‚   â”œâ”€â”€ FrameVersion.cs             // SLMPãƒ•ãƒ¬ãƒ¼ãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ—æŒ™å‹
â”‚   â”‚   â”œâ”€â”€ ResourceType.cs             // ãƒªã‚½ãƒ¼ã‚¹ç¨®åˆ¥åˆ—æŒ™å‹
â”‚   â”‚   â”œâ”€â”€ ConnectionResponse.cs       // ConnectAsyncæˆ»ã‚Šå€¤
â”‚   â”‚   â”œâ”€â”€ ConnectionStats.cs          // DisconnectAsyncæˆ»ã‚Šå€¤
â”‚   â”‚   â”œâ”€â”€ ProcessedResponseData.cs    // PostprocessReceivedDataæˆ»ã‚Šå€¤
â”‚   â”‚   â”œâ”€â”€ DeviceSpecification.cs      // ãƒ‡ãƒã‚¤ã‚¹æŒ‡å®šæƒ…å ±ï¼ˆReadRandomç”¨ã€Phase1å®Ÿè£…ï¼‰
â”‚   â”‚   â”œâ”€â”€ DeviceData.cs               // ãƒ‡ãƒã‚¤ã‚¹ãƒ‡ãƒ¼ã‚¿è¡¨ç¾ï¼ˆReadRandomãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ã€Phase5å®Ÿè£…ï¼‰
â”‚   â”‚   â”œâ”€â”€ SlmpHeader.cs              // SLMPãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
â”‚   â”‚   â”œâ”€â”€ StructuredData.cs          // ParseRawToStructuredDataæˆ»ã‚Šå€¤
â”‚   â”‚   â”œâ”€â”€ ProcessedDeviceRequestInfo.cs // DWordåˆ†å‰²å‡¦ç†çµæœ
â”‚   â”‚   â”œâ”€â”€ InitializationResult.cs     // Step1åˆæœŸåŒ–çµæœ
â”‚   â”‚   â”œâ”€â”€ CycleExecutionResult.cs     // ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œçµæœ
â”‚   â”‚   â”œâ”€â”€ ShutdownResult.cs           // é©åˆ‡ãªçµ‚äº†å‡¦ç†çµæœ
â”‚   â”‚   â”œâ”€â”€ AsyncOperationResult.cs     // éåŒæœŸå‡¦ç†å®Ÿè¡Œçµæœ
â”‚   â”‚   â”œâ”€â”€ GeneralOperationResult.cs   // ä¸€èˆ¬å‡¦ç†ä¸€æ‹¬å®Ÿè¡Œçµæœ
â”‚   â”‚   â”œâ”€â”€ ParallelExecutionResult.cs  // ä¸¦è¡Œå®Ÿè¡Œçµæœ
â”‚   â”‚   â”œâ”€â”€ ProgressInfo.cs             // é€²æ—å ±å‘ŠåŸºåº•ã‚¯ãƒ©ã‚¹
â”‚   â”‚   â”œâ”€â”€ ParallelProgressInfo.cs     // ä¸¦è¡Œå®Ÿè¡Œé€²æ—å ±å‘Šå°‚ç”¨
â”‚   â”‚   â””â”€â”€ ConfigModels/              // è¨­å®šé–¢é€£ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚       â”œâ”€â”€ ConnectionConfig.cs
â”‚   â”‚       â”œâ”€â”€ TimeoutConfig.cs
â”‚   â”‚       â”œâ”€â”€ TargetDeviceConfig.cs
â”‚   â”‚       â”œâ”€â”€ DeviceEntry.cs          // è¨­å®šèª­ã¿è¾¼ã¿ç”¨ä¸­é–“å‹ï¼ˆPhase6å®Ÿè£…ï¼‰
â”‚   â”‚       â”œâ”€â”€ DeviceEntryInfo.cs      // ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›ç”¨è¨­å®šæƒ…å ±ï¼ˆPhase7å®Ÿè£…ï¼‰
â”‚   â”‚       â”œâ”€â”€ SystemResourcesConfig.cs
â”‚   â”‚       â”œâ”€â”€ DataProcessingConfig.cs
â”‚   â”‚       â”œâ”€â”€ LoggingConfig.cs
â”‚   â”‚       â””â”€â”€ DataTransferConfig.cs
â”‚   â”œâ”€â”€ Interfaces/
â”‚   â”‚   â”œâ”€â”€ IApplicationController.cs     // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“åˆ¶å¾¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ IExecutionOrchestrator.cs     // å®Ÿè¡Œåˆ¶å¾¡ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ IConfigurationWatcher.cs      // è¨­å®šç›£è¦–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ IConfigToFrameManager.cs
â”‚   â”‚   â”œâ”€â”€ IPlcCommunicationManager.cs  // æœ€é‡è¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ IDataOutputManager.cs
â”‚   â”‚   â”œâ”€â”€ ILoggingManager.cs
â”‚   â”‚   â”œâ”€â”€ IErrorHandler.cs
â”‚   â”‚   â”œâ”€â”€ IResourceManager.cs
â”‚   â”‚   â”œâ”€â”€ IAsyncExceptionHandler.cs     // éšå±¤çš„ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”‚   â”œâ”€â”€ ICancellationCoordinator.cs   // ã‚­ãƒ£ãƒ³ã‚»ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
â”‚   â”‚   â”œâ”€â”€ IResourceSemaphoreManager.cs  // å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹æ’ä»–åˆ¶å¾¡
â”‚   â”‚   â”œâ”€â”€ IProgressReporter.cs          // é€²æ—å ±å‘Š
â”‚   â”‚   â”œâ”€â”€ IParallelExecutionController.cs // ä¸¦è¡Œå®Ÿè¡Œåˆ¶å¾¡
â”‚   â”‚   â”œâ”€â”€ ITimerService.cs              // ã‚¿ã‚¤ãƒãƒ¼åˆ¶å¾¡
â”‚   â”‚   â””â”€â”€ IMultiConfigDIIntegration.cs  // è¤‡æ•°è¨­å®šDIçµ±åˆ
â”‚   â”œâ”€â”€ Exceptions/
â”‚   â”‚   â””â”€â”€ MultiConfigLoadException.cs  // è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ä¾‹å¤–ï¼ˆã‚«ã‚¹ã‚¿ãƒ ï¼‰
â”‚   â”‚                                    // ãã®ä»–ã¯.NETæ¨™æº–ä¾‹å¤–ã‚’ä½¿ç”¨
â”‚   â””â”€â”€ Constants/
â”‚       â”œâ”€â”€ SlmpConstants.cs            // SLMPé–¢é€£å®šæ•°
â”‚       â”œâ”€â”€ DeviceConstants.cs          // ãƒ‡ãƒã‚¤ã‚¹ã‚³ãƒ¼ãƒ‰åˆ—æŒ™å‹ãƒ»æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆPhase1å®Ÿè£…ï¼‰
â”‚       â”œâ”€â”€ ErrorConstants.cs           // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰å®šæ•°
â”‚       â””â”€â”€ ErrorMessages.cs            // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸çµ±ä¸€ç®¡ç†
â”œâ”€â”€ Infrastructure/
â”‚   â”œâ”€â”€ Logging/
â”‚   â”‚   â”œâ”€â”€ FileLogger.cs
â”‚   â”‚   â”œâ”€â”€ ConsoleLogger.cs
â”‚   â”‚   â””â”€â”€ LoggerFactory.cs
â”‚   â”œâ”€â”€ Configuration/
â”‚   â”‚   â”œâ”€â”€ ConfigurationLoader.cs
â”‚   â”‚   â”‚   // LoadPlcConnectionConfig() - PLCæ¥ç¶šè¨­å®šèª­ã¿è¾¼ã¿
â”‚   â”‚   â”‚   // ValidateConfig() - è¨­å®šå†…å®¹æ¤œè¨¼
â”‚   â”‚   â””â”€â”€ SettingsValidator.cs
â”‚   â””â”€â”€ Network/
â”‚       â”œâ”€â”€ TcpClient.cs
â”‚       â”œâ”€â”€ UdpClient.cs
â”‚       â””â”€â”€ NetworkHelpers.cs
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ AndonHostedService.cs             // ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã‚µãƒ¼ãƒ“ã‚¹ï¼ˆç¶™ç¶šå®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰ï¼‰
â”‚   â”œâ”€â”€ GracefulShutdownHandler.cs        // é©åˆ‡ãªçµ‚äº†å‡¦ç†ãƒ»ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾
â”‚   â”œâ”€â”€ TimerService.cs                   // MonitoringIntervalMsé–“éš”ã‚¿ã‚¤ãƒãƒ¼åˆ¶å¾¡
â”‚   â”œâ”€â”€ AsyncExceptionHandler.cs          // éšå±¤çš„ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”œâ”€â”€ CancellationCoordinator.cs        // ã‚­ãƒ£ãƒ³ã‚»ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
â”‚   â”œâ”€â”€ ResourceSemaphoreManager.cs       // å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹æ’ä»–åˆ¶å¾¡
â”‚   â”œâ”€â”€ ProgressReporter.cs               // é€²æ—å ±å‘Š
â”‚   â”œâ”€â”€ ParallelExecutionController.cs    // ä¸¦è¡Œå®Ÿè¡Œåˆ¶å¾¡
â”‚   â”œâ”€â”€ DependencyInjectionConfigurator.cs  // DIã‚³ãƒ³ãƒ†ãƒŠè¨­å®š
â”‚   â”œâ”€â”€ OptionsConfigurator.cs            // Optionsãƒ‘ã‚¿ãƒ¼ãƒ³è¨­å®š
â”‚   â”œâ”€â”€ ServiceLifetimeManager.cs         // ã‚µãƒ¼ãƒ“ã‚¹ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ç®¡ç†
â”‚   â””â”€â”€ MultiConfigDIIntegration.cs       // è¤‡æ•°è¨­å®šDIçµ±åˆ
â”œâ”€â”€ Utilities/
â”‚   â”œâ”€â”€ SlmpFrameBuilder.cs             // SLMPãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚                                   // BuildReadRandomRequest() - ReadRandom(0x0403) Binaryå½¢å¼
â”‚   â”‚                                   // BuildReadRandomRequestAscii() - ReadRandom(0x0403) ASCIIå½¢å¼
â”‚   â”œâ”€â”€ SlmpDataParser.cs               // SLMPãƒ‡ãƒ¼ã‚¿ãƒ‘ãƒ¼ã‚¹ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚                                   // ParseReadRandomResponse() - ReadRandomãƒ¬ã‚¹ãƒãƒ³ã‚¹è§£æ
â”‚   â”‚                                   // ValidateResponseFrame() - ãƒ•ãƒ¬ãƒ¼ãƒ æ¤œè¨¼
â”‚   â”œâ”€â”€ DataConverter.cs                // ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ DeviceAddressParser.cs          // ãƒ‡ãƒã‚¤ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹è§£æ
â”‚   â”œâ”€â”€ HexStringFormatter.cs           // 16é€²æ•°æ–‡å­—åˆ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
â”‚   â”œâ”€â”€ CsvFileWriter.cs                // CSVå‡ºåŠ›ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚                                   // WriteToFileAsync() - CSVå½¢å¼ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›
â”‚   â”‚                                   // CleanupOldFilesAsync() - å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
â”‚   â””â”€â”€ DataTransferManager.cs          // ãƒ‡ãƒ¼ã‚¿è»¢é€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
â”‚                                       // TransferDataAsync() - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è»¢é€
â””â”€â”€ Tests/
    â”œâ”€â”€ Unit/
    â”‚   â”œâ”€â”€ Core/
    â”‚   â”‚   â”œâ”€â”€ Controllers/
    â”‚   â”‚   â”‚   â”œâ”€â”€ ApplicationControllerTests.cs
    â”‚   â”‚   â”‚   â”œâ”€â”€ ExecutionOrchestratorTests.cs
    â”‚   â”‚   â”‚   â””â”€â”€ ConfigurationWatcherTests.cs
    â”‚   â”‚   â”œâ”€â”€ Managers/
    â”‚   â”‚   â”‚   â”œâ”€â”€ ConfigToFrameManagerTests.cs
    â”‚   â”‚   â”‚   â”œâ”€â”€ PlcCommunicationManagerTests.cs  // æœ€å„ªå…ˆãƒ†ã‚¹ãƒˆ
    â”‚   â”‚   â”‚   â”œâ”€â”€ DataOutputManagerTests.cs
    â”‚   â”‚   â”‚   â”œâ”€â”€ LoggingManagerTests.cs
    â”‚   â”‚   â”‚   â”œâ”€â”€ ErrorHandlerTests.cs
    â”‚   â”‚   â”‚   â””â”€â”€ ResourceManagerTests.cs
    â”‚   â”‚   â””â”€â”€ Models/
    â”‚   â”‚       â”œâ”€â”€ ConnectionResponseTests.cs
    â”‚   â”‚       â”œâ”€â”€ ConnectionStatsTests.cs
    â”‚   â”‚       â”œâ”€â”€ ProcessedResponseDataTests.cs
    â”‚   â”‚       â”œâ”€â”€ DeviceSpecificationTests.cs
    â”‚   â”‚       â”œâ”€â”€ DeviceDataTests.cs
    â”‚   â”‚       â”œâ”€â”€ SlmpHeaderTests.cs
    â”‚   â”‚       â”œâ”€â”€ StructuredDataTests.cs
    â”‚   â”‚       â”œâ”€â”€ ProcessedDeviceRequestInfoTests.cs
    â”‚   â”‚       â”œâ”€â”€ InitializationResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ CycleExecutionResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ ShutdownResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ AsyncOperationResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ GeneralOperationResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ ParallelExecutionResultTests.cs
    â”‚   â”‚       â”œâ”€â”€ ProgressInfoTests.cs
    â”‚   â”‚       â””â”€â”€ ParallelProgressInfoTests.cs
    â”‚   â”œâ”€â”€ Infrastructure/
    â”‚   â”‚   â”œâ”€â”€ Logging/
    â”‚   â”‚   â”œâ”€â”€ Configuration/
    â”‚   â”‚   â””â”€â”€ Network/
    â”‚   â”œâ”€â”€ Constants/
    â”‚   â”‚   â””â”€â”€ DeviceConstantsTests.cs
    â”‚   â””â”€â”€ Utilities/
    â”‚       â”œâ”€â”€ SlmpFrameBuilderTests.cs
    â”‚       â”œâ”€â”€ SlmpDataParserTests.cs
    â”‚       â”œâ”€â”€ DataConverterTests.cs
    â”‚       â”œâ”€â”€ DeviceAddressParserTests.cs
    â”‚       â””â”€â”€ HexStringFormatterTests.cs
    â”‚   â”œâ”€â”€ Services/
    â”‚   â”‚   â”œâ”€â”€ AndonHostedServiceTests.cs
    â”‚   â”‚   â”œâ”€â”€ GracefulShutdownHandlerTests.cs
    â”‚   â”‚   â”œâ”€â”€ TimerServiceTests.cs
    â”‚   â”‚   â”œâ”€â”€ AsyncExceptionHandlerTests.cs
    â”‚   â”‚   â”œâ”€â”€ CancellationCoordinatorTests.cs
    â”‚   â”‚   â”œâ”€â”€ ResourceSemaphoreManagerTests.cs
    â”‚   â”‚   â”œâ”€â”€ ProgressReporterTests.cs
    â”‚   â”‚   â”œâ”€â”€ ParallelExecutionControllerTests.cs
    â”‚   â”‚   â”œâ”€â”€ DependencyInjectionConfiguratorTests.cs
    â”‚   â”‚   â”œâ”€â”€ OptionsConfiguratorTests.cs
    â”‚   â”‚   â”œâ”€â”€ ServiceLifetimeManagerTests.cs
    â”‚   â”‚   â””â”€â”€ MultiConfigDIIntegrationTests.cs
    â”œâ”€â”€ Integration/
    â”‚   â”œâ”€â”€ Step1_2_IntegrationTests.cs    // è¨­å®šï½ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰çµ±åˆ
    â”‚   â”œâ”€â”€ Step3_6_IntegrationTests.cs    // PLCé€šä¿¡å…¨ä½“çµ±åˆ (æœ€å„ªå…ˆ)
    â”‚   â””â”€â”€ ErrorHandling_IntegrationTests.cs
    â”œâ”€â”€ Performance/
    â”‚   â”œâ”€â”€ MemoryUsageTests.cs
    â”‚   â””â”€â”€ ResponseTimeTests.cs
    â””â”€â”€ TestUtilities/
        â”œâ”€â”€ Mocks/
        â”‚   â”œâ”€â”€ MockApplicationController.cs
        â”‚   â”œâ”€â”€ MockExecutionOrchestrator.cs
        â”‚   â”œâ”€â”€ MockPlcCommunicationManager.cs
        â”‚   â”œâ”€â”€ MockConfigToFrameManager.cs
        â”‚   â”œâ”€â”€ MockMultiConfigManager.cs
        â”‚   â”œâ”€â”€ MockLoggingManager.cs
        â”‚   â”œâ”€â”€ MockErrorHandler.cs
        â”‚   â”œâ”€â”€ MockResourceManager.cs
        â”‚   â”œâ”€â”€ MockDataOutputManager.cs
        â”‚   â”œâ”€â”€ MockAsyncExceptionHandler.cs
        â”‚   â”œâ”€â”€ MockCancellationCoordinator.cs
        â”‚   â”œâ”€â”€ MockResourceSemaphoreManager.cs
        â”‚   â”œâ”€â”€ MockProgressReporter.cs
        â”‚   â”œâ”€â”€ MockParallelExecutionController.cs
        â”‚   â”œâ”€â”€ MockTimerService.cs
        â”‚   â””â”€â”€ MockConfigurationWatcher.cs
        â”œâ”€â”€ Stubs/
        â”‚   â”œâ”€â”€ ConfigurationStubs.cs
        â”‚   â”œâ”€â”€ NetworkStubs.cs
        â”‚   â””â”€â”€ PlcResponseStubs.cs
        â””â”€â”€ TestData/
            â”œâ”€â”€ SampleConfigurations/
            â”œâ”€â”€ SlmpFrameSamples/
            â””â”€â”€ PlcResponseSamples/
```

---

## ä¸»è¦ã‚¯ãƒ©ã‚¹ãƒ»æ©Ÿèƒ½æ¦‚è¦

**è©³ç´°ãªè¨­è¨ˆæƒ…å ±ã¯ `ã‚¯ãƒ©ã‚¹è¨­è¨ˆ.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

### Step1-2: è¨­å®šèª­ã¿è¾¼ã¿ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
- **ConfigToFrameManager**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã€ReadRandom(0x0403)ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
  - BuildReadRandomFrameFromConfig() - Binaryå½¢å¼ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
  - BuildReadRandomFrameFromConfigAscii() - ASCIIå½¢å¼ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
- **ConfigurationLoader**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ãƒ»æ¤œè¨¼
  - LoadPlcConnectionConfig() - è¨­å®šèª­ã¿è¾¼ã¿ã€DeviceEntry â†’ DeviceSpecificationå¤‰æ›
  - ValidateConfig() - è¨­å®šå†…å®¹æ¤œè¨¼
- **MultiConfigManager**: è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«çµ±åˆç®¡ç†ï¼ˆå…±æœ‰ãƒ‡ãƒ¼ã‚¿ + è»½é‡ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼‰

### Step3-6: PLCé€šä¿¡ãƒ»ãƒ‡ãƒ¼ã‚¿å‡¦ç†
- **PlcCommunicationManager**: PLCæ¥ç¶š/åˆ‡æ–­ã€ãƒ‡ãƒ¼ã‚¿é€å—ä¿¡ã€3æ®µéšãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆåŸºæœ¬å¾Œå‡¦ç†â†’DWordçµåˆâ†’æ§‹é€ åŒ–å¤‰æ›ï¼‰
- **MultiPlcCoordinator**: è¤‡æ•°PLCä¸¦åˆ—å®Ÿè¡Œèª¿æ•´ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼ˆTask.WhenAll/é †æ¬¡å‡¦ç†ã®åˆ‡ã‚Šæ›¿ãˆã€ç´„50è¡Œï¼‰

### Step7: ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›
- **DataOutputManager**: æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ãƒ»ä¿å­˜

### ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ©Ÿèƒ½
- **SlmpFrameBuilder**: SLMPãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  - BuildReadRandomRequest() - ReadRandom(0x0403) Binaryå½¢å¼ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
  - BuildReadRandomRequestAscii() - ReadRandom(0x0403) ASCIIå½¢å¼ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
- **SlmpDataParser**: SLMPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ¼ã‚¹
  - ParseReadRandomResponse() - ReadRandomãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®è§£æã€DeviceDataãƒ‡ã‚£ã‚¯ã‚·ãƒ§ãƒŠãƒªç”Ÿæˆ
  - ValidateResponseFrame() - ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ãƒ¬ãƒ¼ãƒ æ¤œè¨¼

### ãƒ­ã‚°ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©æ©Ÿèƒ½
- **LoggingManager**: SLMPé€šä¿¡å¯è¦–åŒ–ã€ãƒ‡ãƒãƒƒã‚°æ”¯æ´ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
- **ErrorHandler**: ã‚¨ãƒ©ãƒ¼åˆ†é¡ã€ãƒªãƒˆãƒ©ã‚¤æ–¹é‡ï¼ˆãƒãƒ©ãƒ³ã‚¹å‹ä¾‹å¤–è¨­è¨ˆï¼‰
- **ResourceManager**: ãƒ¡ãƒ¢ãƒªç›£è¦–ã€ãƒªã‚½ãƒ¼ã‚¹æœ€é©åŒ–

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
- **ApplicationController**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
- **ExecutionOrchestrator**: Step2-7ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œåˆ¶å¾¡ï¼ˆå˜ä¸€PLC + è¤‡æ•°PLCä¸¦åˆ—å¯¾å¿œï¼‰
- **AndonHostedService**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œï¼ˆç¶™ç¶šå®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰ï¼‰
- **GracefulShutdownHandler**: é©åˆ‡ãªçµ‚äº†å‡¦ç†

### éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†
- **AsyncExceptionHandler**: éšå±¤çš„ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **CancellationCoordinator**: ã‚­ãƒ£ãƒ³ã‚»ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡
- **ResourceSemaphoreManager**: å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹æ’ä»–åˆ¶å¾¡
- **ParallelExecutionController**: è¤‡æ•°PLCä¸¦è¡Œå®Ÿè¡Œåˆ¶å¾¡
- **ProgressReporter<T>**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€²æ—å ±å‘Š

### DIãƒ»è¨­å®šç®¡ç†
- **DependencyInjectionConfigurator**: DIã‚³ãƒ³ãƒ†ãƒŠè¨­å®š
- **OptionsConfigurator**: Optionsãƒ‘ã‚¿ãƒ¼ãƒ³è¨­å®šå€¤æ³¨å…¥
- **MultiConfigDIIntegration**: è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«DIçµ±åˆ

### ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
- **Program**: Hostæ§‹ç¯‰ã€æœ€ä¸Šä½ä¾‹å¤–å‡¦ç†
- **CommandLineOptions**: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°è§£æ
- **ExitCodeManager**: çµ‚äº†ã‚³ãƒ¼ãƒ‰ç®¡ç†

---

## Modelsæ¦‚è¦

**è©³ç´°ãªModelsã‚¯ãƒ©ã‚¹è¨­è¨ˆã«ã¤ã„ã¦ã¯ `ã‚¯ãƒ©ã‚¹è¨­è¨ˆ.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

### ä¸»è¦Modelsã‚¯ãƒ©ã‚¹ä¸€è¦§

#### åˆ—æŒ™å‹ï¼ˆCore/Models/, Core/Constants/ï¼‰
- **ConnectionStatus**: æ¥ç¶šçŠ¶æ…‹åˆ—æŒ™å‹ï¼ˆConnected/Failed/Timeoutï¼‰
- **ConnectionType**: æ¥ç¶šã‚¿ã‚¤ãƒ—åˆ—æŒ™å‹ï¼ˆEthernet/Serial/USBï¼‰
- **FrameVersion**: SLMPãƒ•ãƒ¬ãƒ¼ãƒ ãƒãƒ¼ã‚¸ãƒ§ãƒ³åˆ—æŒ™å‹ï¼ˆFrame3E/Frame4Eï¼‰
- **ResourceType**: ãƒªã‚½ãƒ¼ã‚¹ç¨®åˆ¥åˆ—æŒ™å‹ï¼ˆLogFile/ConfigFile/OutputFileï¼‰
- **DeviceCode**: ãƒ‡ãƒã‚¤ã‚¹ã‚³ãƒ¼ãƒ‰åˆ—æŒ™å‹ï¼ˆM, D, W, X, Yç­‰ï¼‰
  - SM=0x91, X=0x9C, Y=0x9D, M=0x90, D=0xA8, W=0xB4ç­‰
  - DeviceCodeExtensionsæ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰: IsHexAddress(), IsBitDevice(), IsReadRandomSupported()

#### è¨­å®šé–¢é€£ï¼ˆCore/Models/ConfigModels/ï¼‰
- **ConnectionConfig**: PLCæ¥ç¶šè¨­å®š
- **TimeoutConfig**: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
- **TargetDeviceConfig**: ãƒ‡ãƒã‚¤ã‚¹è¨­å®šï¼ˆList<DeviceSpecification>å‹ã§ãƒªã‚¹ãƒˆå½¢å¼ï¼‰
- **DeviceEntry**: è¨­å®šèª­ã¿è¾¼ã¿ç”¨ä¸­é–“å‹ï¼ˆappsettings.jsonâ†’DeviceSpecificationå¤‰æ›ç”¨ï¼‰
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: DeviceType (string), DeviceNumber (int), IsHexAddress (bool), Description (string?)
  - ãƒ¡ã‚½ãƒƒãƒ‰: ToDeviceSpecification()
- **DeviceEntryInfo**: ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›ç”¨è¨­å®šæƒ…å ±ï¼ˆPhase7å®Ÿè£…ï¼‰
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: Name (string), Digits (int)
  - ç”¨é€”: DataOutputManagerã®JSONå‡ºåŠ›æ™‚ã«ãƒ‡ãƒã‚¤ã‚¹èª¬æ˜æƒ…å ±ã‚’æä¾›
- **SystemResourcesConfig**: ãƒªã‚½ãƒ¼ã‚¹åˆ¶é™è¨­å®š
- **DataProcessingConfig**: ãƒ‡ãƒ¼ã‚¿å‡¦ç†è¨­å®š
- **LoggingConfig**: ãƒ­ã‚°è¨­å®š
- **DataTransferConfig**: ãƒ‡ãƒ¼ã‚¿è»¢é€è¨­å®š
- **MultiPlcConfig**: è¤‡æ•°PLCè¨­å®šã®ãƒ«ãƒ¼ãƒˆï¼ˆPlcConnections + ParallelConfigï¼‰
- **ParallelProcessingConfig**: ä¸¦åˆ—å‡¦ç†è¨­å®šï¼ˆEnableParallel, MaxDegreeOfParallelism, OverallTimeoutMsï¼‰
- **PlcConnectionConfig**: å€‹åˆ¥PLCæ¥ç¶šè¨­å®šï¼ˆPlcId, PlcName, Priorityè¿½åŠ ï¼‰

#### PLCé€šä¿¡é–¢é€£ï¼ˆCore/Models/ï¼‰
- **ConnectionResponse**: æ¥ç¶šå‡¦ç†çµæœ
- **ConnectionStats**: é€šä¿¡çµ±è¨ˆæƒ…å ±
- **ProcessedResponseData**: å—ä¿¡ãƒ‡ãƒ¼ã‚¿å¾Œå‡¦ç†çµæœ
- **ProcessedDeviceRequestInfo**: ãƒ‡ãƒã‚¤ã‚¹è¦æ±‚æƒ…å ±ï¼ˆTC029/TC037ãƒ†ã‚¹ãƒˆç”¨ï¼‰
- **DeviceSpecification**: ãƒ‡ãƒã‚¤ã‚¹æŒ‡å®šæƒ…å ±ã‚¯ãƒ©ã‚¹ï¼ˆReadRandomç”¨ï¼‰
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: Code (DeviceCode), DeviceNumber (int), IsHexAddress (bool)
  - ãƒ¡ã‚½ãƒƒãƒ‰: FromHexString(), ToDeviceNumberBytes(), ToDeviceSpecificationBytes(), ValidateForReadRandom()
  - ç”¨é€”: ReadRandom(0x0403)ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰ã€ä¸é€£ç¶šãƒ‡ãƒã‚¤ã‚¹æŒ‡å®š
- **DeviceData**: ãƒ‡ãƒã‚¤ã‚¹ãƒ‡ãƒ¼ã‚¿è¡¨ç¾ã‚¯ãƒ©ã‚¹ï¼ˆRandom READãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ï¼‰
  - ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: DeviceName (string), Code (DeviceCode), Address (int), Value (uint), IsDWord (bool), IsHexAddress (bool)
  - ãƒ¡ã‚½ãƒƒãƒ‰: FromDeviceSpecification(), FromDWordDevice()
  - ãƒ‡ãƒã‚¤ã‚¹åã‚­ãƒ¼æ§‹é€ : "M000", "D000", "D002"ç­‰
  - ç”¨é€”: ReadRandomå¿œç­”ãƒ‡ãƒ¼ã‚¿ã®ãƒ‘ãƒ¼ã‚¹çµæœä¿æŒ
- **SlmpHeader**: SLMPãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
- **StructuredData**: æ§‹é€ åŒ–è§£æçµæœ

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡é–¢é€£ï¼ˆCore/Models/ï¼‰
- **InitializationResult**: Step1åˆæœŸåŒ–å‡¦ç†çµæœ
- **CycleExecutionResult**: Step2-7å˜ä¸€ã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œçµæœ
- **ShutdownResult**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å‡¦ç†çµæœ
- **MultiPlcExecutionResult**: è¤‡æ•°PLCå®Ÿè¡Œçµæœï¼ˆPlcResults, SuccessCount, FailureCount, TotalDurationï¼‰
- **PlcExecutionResult**: å˜ä¸€PLCå®Ÿè¡Œçµæœï¼ˆPlcId, Duration, DeviceData, ParsedDeviceDataï¼‰

#### éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†é–¢é€£ï¼ˆCore/Models/ï¼‰
- **AsyncOperationResult<T>**: é‡è¦å‡¦ç†ã®éåŒæœŸå®Ÿè¡Œçµæœ
- **GeneralOperationResult**: ä¸€èˆ¬å‡¦ç†ã®ä¸€æ‹¬å®Ÿè¡Œçµæœ
- **ParallelExecutionResult**: è¤‡æ•°PLCä¸¦è¡Œå®Ÿè¡Œçµæœ
- **ProgressInfo**: é€²æ—å ±å‘ŠåŸºåº•ã‚¯ãƒ©ã‚¹
- **ParallelProgressInfo**: ä¸¦è¡Œå®Ÿè¡Œé€²æ—å ±å‘Šå°‚ç”¨

---

## ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ¦‚è¦

**è©³ç´°ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆã¯ `ã‚¯ãƒ©ã‚¹è¨­è¨ˆ.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

### è¨­è¨ˆæ–¹é‡
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ç¢ºä¿**: å…¨ä¸»è¦ã‚¯ãƒ©ã‚¹ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…
- **ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–å¯¾å¿œ**: ãƒ†ã‚¹ãƒˆæ™‚ã®å¤–éƒ¨ä¾å­˜æ’é™¤
- **TDDæ‰‹æ³•ã‚µãƒãƒ¼ãƒˆ**: Red-Green-Refactorã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œæ”¯æ´
- **å¥‘ç´„ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§å…¥å‡ºåŠ›ã‚’æ˜ç¢ºåŒ–

### ä¸»è¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- **ã‚³ã‚¢æ©Ÿèƒ½ç³»**: IApplicationController, IExecutionOrchestrator, IConfigToFrameManager, IPlcCommunicationManager, IDataOutputManager
- **ã‚¤ãƒ³ãƒ•ãƒ©ç³»**: ILoggingManager, IErrorHandler, IResourceManager
- **éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†ç³»**: IAsyncExceptionHandler, ICancellationCoordinator, IResourceSemaphoreManager, IProgressReporter, IParallelExecutionController
- **DIçµ±åˆç³»**: IMultiConfigDIIntegration

---

## DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰è¨­è¨ˆæ¦‚è¦

**è©³ç´°ãªDIè¨­è¨ˆã¯ `ã‚¯ãƒ©ã‚¹è¨­è¨ˆ.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

### è¨­è¨ˆæ–¹é‡
- **DIãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: Microsoft.Extensions.DependencyInjectionï¼ˆ.NETæ¨™æº–ï¼‰
- **ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ è¨­è¨ˆ**: ç”¨é€”åˆ¥ï¼ˆSingleton: å…±æœ‰ãƒªã‚½ãƒ¼ã‚¹ãƒ»çµ±è¨ˆç®¡ç†ã€Transient: PLCåˆ¥ãƒ»è¨­å®šåˆ¥ï¼‰
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç™»éŒ²**: å…¨ä¸»è¦ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çµŒç”±ç™»éŒ²
- **è¨­å®šå€¤æ³¨å…¥**: Optionsãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ç”¨ï¼ˆå‹å®‰å…¨æ€§ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œï¼‰

### ã‚µãƒ¼ãƒ“ã‚¹ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ 
- **Singleton**: ApplicationController, LoggingManager, ErrorHandler, ResourceManager, å„ç¨®éåŒæœŸå‡¦ç†ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- **Transient**: ExecutionOrchestrator, ConfigToFrameManager, PlcCommunicationManager, ProgressReporter, TimerService

---

## TDDå®Ÿè£…é †åº

### Phase 1: PlcCommunicationManager (æœ€å„ªå…ˆ)
1. **ConnectAsync** - PLCæ¥ç¶šæ©Ÿèƒ½
2. **SendFrameAsync** - ãƒ•ãƒ¬ãƒ¼ãƒ é€ä¿¡æ©Ÿèƒ½
3. **ReceiveResponseAsync** - ãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡æ©Ÿèƒ½
4. **PostprocessReceivedData** - DWordçµåˆå‡¦ç†
5. **ParseRawToStructuredData** - æ§‹é€ åŒ–å¤‰æ›
6. **DisconnectAsync** - åˆ‡æ–­ãƒ»çµ±è¨ˆå–å¾—

### Phase 2: Infrastructureç³»
1. **LoggingManager** - ãƒ­ã‚°å‡ºåŠ›æ©Ÿèƒ½
2. **ErrorHandler** - ã‚¨ãƒ©ãƒ¼åˆ†é¡ãƒ»å‡¦ç†
3. **ResourceManager** - ãƒ¡ãƒ¢ãƒªç®¡ç†

### Phase 3: ConfigToFrameManager
1. **LoadConfigAsync** - è¨­å®šèª­ã¿è¾¼ã¿
2. **GetConfig** - è¨­å®šå–å¾—
3. **SplitDwordToWord** - DWordåˆ†å‰²å‡¦ç†
4. **BuildFrames** - ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰

### Phase 4: DataOutputManager
1. **OutputDataAsync** - ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›æ©Ÿèƒ½

### Phase 5: çµ±åˆãƒ†ã‚¹ãƒˆ
1. **Step1-2çµ±åˆ** - è¨­å®šï½ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹ç¯‰
2. **Step3-6çµ±åˆ** - PLCé€šä¿¡å…¨ä½“
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±åˆ**

---

## ãƒ†ã‚¹ãƒˆè¨­è¨ˆã¨ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã®å¯¾å¿œ

**è©³ç´°ãªãƒ†ã‚¹ãƒˆè¨­è¨ˆã¯ `ãƒ†ã‚¹ãƒˆå†…å®¹.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**

### ãƒ†ã‚¹ãƒˆPhaseå®Ÿè¡Œé †åºã¨ãƒ•ã‚©ãƒ«ãƒ€å¯¾å¿œ

#### Phase 1: ConfigToFrameManagerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC001-TC016)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/ConfigToFrameManagerTests.cs`
- LoadConfigAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC001-TC004)
- GetConfig ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC005-TC007)
- SplitDwordToWord ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC008-TC011)
- BuildFrames ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC012-TC016)
- MultiConfigManager ãƒ†ã‚¹ãƒˆ (TC016_1-TC016_12)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockConfigToFrameManager.cs`, `Tests/TestUtilities/Stubs/ConfigurationStubs.cs`

#### Phase 2: PlcCommunicationManagerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC017-TC030) - æœ€å„ªå…ˆ
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/PlcCommunicationManagerTests.cs`
- ConnectAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC017-TC020_5)
- SendFrameAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC021-TC023)
- ReceiveResponseAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC019-TC020)
- DisconnectAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC021-TC022)
- ProcessReceivedRawData ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC023-TC025)
- CombineDwordData ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC026-TC030)
- ParseRawToStructuredData ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC031-TC035)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockPlcCommunicationManager.cs`, `Tests/TestUtilities/Stubs/NetworkStubs.cs`, `Tests/TestUtilities/Stubs/PlcResponseStubs.cs`

#### Phase 3: LoggingManagerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC031-TC034_10)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/LoggingManagerTests.cs`
- InitializeAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC031-TC032)
- å„ãƒ­ã‚°å‡ºåŠ›ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC033-TC034_10)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockLoggingManager.cs`

#### Phase 4: ErrorHandlerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC035-TC038_18)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/ErrorHandlerTests.cs`
- DetermineErrorCategory ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC035-TC036)
- ApplyRetryPolicy ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC037-TC038)
- RecordError, ApplyErrorPolicy ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC038_1-TC038_2)
- ErrorMessages ãƒ†ã‚¹ãƒˆ (TC038_3-TC038_9)
- MultiConfigLoadException ãƒ†ã‚¹ãƒˆ (TC038_10-TC038_15)
- ãƒãƒ©ãƒ³ã‚¹å‹ä¾‹å¤–å‡¦ç†çµ±åˆãƒ†ã‚¹ãƒˆ (TC038_16-TC038_18)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockErrorHandler.cs`

#### Phase 5: ResourceManagerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC039-TC041_4)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/ResourceManagerTests.cs`
- GetMemoryUsage ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC039)
- EvaluateLevel ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC040-TC041)
- ApplyDataAndLoggingPolicy, OptimizeMemory, WriteLogAsync, RunMonitoringLoopAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC041_1-TC041_4)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockResourceManager.cs`

#### Phase 6: DataOutputManagerå˜ä½“ãƒ†ã‚¹ãƒˆ (TC042-TC046)
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Managers/DataOutputManagerTests.cs`
- OutputDataAsync ãƒ¡ã‚½ãƒƒãƒ‰ãƒ†ã‚¹ãƒˆ (TC042-TC046)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockDataOutputManager.cs`

#### Phase 7: ApplicationControllerãƒ»ExecutionOrchestratorå˜ä½“ãƒ†ã‚¹ãƒˆ (TC052-TC070) - é«˜å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**:
- `Tests/Unit/Core/Controllers/ApplicationControllerTests.cs` (TC052-TC057)
- `Tests/Unit/Core/Controllers/ExecutionOrchestratorTests.cs` (TC058-TC062, TC032: ExecuteMultiPlcCycleAsync)
- `Tests/Unit/Services/AndonHostedServiceTests.cs` (TC063-TC065)
- `Tests/Unit/Services/TimerServiceTests.cs` (TC066-TC067)
- `Tests/Unit/Services/GracefulShutdownHandlerTests.cs` (TC068-TC070)
- `Tests/Unit/Core/Managers/MultiPlcCoordinatorTests.cs` (TC030-TC031: ä¸¦åˆ—/é †æ¬¡å‡¦ç†)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockApplicationController.cs`, `Tests/TestUtilities/Mocks/MockExecutionOrchestrator.cs`, `Tests/TestUtilities/Mocks/MockTimerService.cs`

#### Phase 8: éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å˜ä½“ãƒ†ã‚¹ãƒˆ (TC071-TC083) - é«˜å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**:
- `Tests/Unit/Services/AsyncExceptionHandlerTests.cs` (TC071-TC074)
- `Tests/Unit/Services/CancellationCoordinatorTests.cs` (TC075-TC076)
- `Tests/Unit/Services/ResourceSemaphoreManagerTests.cs` (TC077-TC078)
- `Tests/Unit/Services/ProgressReporterTests.cs` (TC079-TC080)
- `Tests/Unit/Services/ParallelExecutionControllerTests.cs` (TC081-TC083)

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: `Tests/TestUtilities/Mocks/MockAsyncExceptionHandler.cs`, `Tests/TestUtilities/Mocks/MockCancellationCoordinator.cs`, `Tests/TestUtilities/Mocks/MockResourceSemaphoreManager.cs`, `Tests/TestUtilities/Mocks/MockProgressReporter.cs`, `Tests/TestUtilities/Mocks/MockParallelExecutionController.cs`

#### Phase 9: DIã‚³ãƒ³ãƒ†ãƒŠè¨­è¨ˆå˜ä½“ãƒ†ã‚¹ãƒˆ (TC084-TC094) - ä¸­å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**:
- `Tests/Unit/Services/DependencyInjectionConfiguratorTests.cs` (TC084-TC088)
- `Tests/Unit/Services/OptionsConfiguratorTests.cs` (TC089-TC090)
- `Tests/Unit/Services/ServiceLifetimeManagerTests.cs` (TC091-TC092)
- `Tests/Unit/Services/MultiConfigDIIntegrationTests.cs` (TC093-TC094)

#### Phase 10: Program.csãƒ»ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆå˜ä½“ãƒ†ã‚¹ãƒˆ (TC095-TC111) - ä¸­å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**:
- `Tests/Unit/ProgramTests.cs` (TC095-TC102)
- `Tests/Unit/CommandLineOptionsTests.cs` (TC103-TC109)
- `Tests/Unit/ExitCodeManagerTests.cs` (TC110-TC111)

#### Phase 11: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ (TC046_1-TC046_16) - ä¸­å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: å„Managerã‚¯ãƒ©ã‚¹ã®å˜ä½“ãƒ†ã‚¹ãƒˆå†…ã§å®Ÿæ–½
- IConfigToFrameManager, IPlcCommunicationManagerç­‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢ãƒ†ã‚¹ãƒˆ
- TDDæ‰‹æ³•ã‚µãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ

**ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–**: å…¨Mockã‚¯ãƒ©ã‚¹ï¼ˆ`Tests/TestUtilities/Mocks/`ï¼‰ã§å®Ÿæ–½

#### Phase 12: Modelsã‚¯ãƒ©ã‚¹å˜ä½“ãƒ†ã‚¹ãƒˆ (TC047_1-TC047_25) - ä½å„ªå…ˆåº¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Unit/Core/Models/`
- ConfigModelsãƒ†ã‚¹ãƒˆ (TC047_1-TC047_10): `ConnectionConfigTests.cs`, `TimeoutConfigTests.cs`, etc.
- PLCé€šä¿¡ç”¨ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ†ã‚¹ãƒˆ (TC047_11-TC047_16): `ConnectionResponseTests.cs`, `ConnectionStatsTests.cs`, `ProcessedResponseDataTests.cs`, `SlmpHeaderTests.cs`, `StructuredDataTests.cs`
- éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†ç”¨ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ†ã‚¹ãƒˆ (TC047_17-TC047_22): `AsyncOperationResultTests.cs`, `GeneralOperationResultTests.cs`, `ParallelExecutionResultTests.cs`, `ProgressInfoTests.cs`, `ParallelProgressInfoTests.cs`
- ApplicationControllerç”¨ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ†ã‚¹ãƒˆ (TC047_23-TC047_25): `InitializationResultTests.cs`, `CycleExecutionResultTests.cs`, `ShutdownResultTests.cs`

#### Phase 13: çµ±åˆãƒ†ã‚¹ãƒˆ (TC048-TC050) - æœ€é‡è¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Integration/`
- Step1-2çµ±åˆãƒ†ã‚¹ãƒˆ: `Step1_2_IntegrationTests.cs` (TC047)
- Step3-6çµ±åˆãƒ†ã‚¹ãƒˆ: `Step3_6_IntegrationTests.cs` (TC048_1-TC048_9) - æœ€å„ªå…ˆ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±åˆãƒ†ã‚¹ãƒˆ: `ErrorHandling_IntegrationTests.cs` (TC049)

#### Phase 14: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ (TC051-TC052) - æœ€é‡è¦
**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `Tests/Performance/`
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ†ã‚¹ãƒˆ: `MemoryUsageTests.cs` (TC050)
- å¿œç­”æ™‚é–“ãƒ†ã‚¹ãƒˆ: `ResponseTimeTests.cs` (TC051)

### ãƒ†ã‚¹ãƒˆçµ±è¨ˆã‚µãƒãƒª

- **ç·ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°**: 254å€‹
- **å˜ä½“ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**: ç´„220å€‹
- **çµ±åˆãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**: ç´„20å€‹
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**: ç´„14å€‹

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºã®æ¨å¥¨

1. **æœ€é‡è¦ï¼ˆPhase 1-2, 13-14ï¼‰**: ConfigToFrameManager, PlcCommunicationManager, çµ±åˆãƒ†ã‚¹ãƒˆ, ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
2. **é«˜å„ªå…ˆåº¦ï¼ˆPhase 7-8ï¼‰**: ApplicationControllerãƒ»ExecutionOrchestrator, éåŒæœŸãƒ»ä¸¦è¡Œå‡¦ç†
3. **ä¸­å„ªå…ˆåº¦ï¼ˆPhase 3-6, 9-11ï¼‰**: å„Managerã‚¯ãƒ©ã‚¹, DIã‚³ãƒ³ãƒ†ãƒŠ, ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ, ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
4. **ä½å„ªå…ˆåº¦ï¼ˆPhase 12ï¼‰**: Modelsã‚¯ãƒ©ã‚¹

### ãƒ†ã‚¹ãƒˆè¨­è¨ˆè©³ç´°ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

è©³ç´°ãªãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å†…å®¹ã€ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–è¨­è¨ˆã€ãƒ†ã‚¹ãƒˆå®Ÿè£…æ–¹é‡ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã‚’å‚ç…§ï¼š
- **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è©³ç´°**: `ãƒ†ã‚¹ãƒˆå†…å®¹.md` ã®ã€Œ## 1. ConfigToFrameManager ãƒ†ã‚¹ãƒˆè¨­è¨ˆã€ä»¥é™
- **ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–è¨­è¨ˆ**: `ãƒ†ã‚¹ãƒˆå†…å®¹.md` ã®ã€Œ## 11. ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–è¨­è¨ˆè©³ç´°ã€
- **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åº**: `ãƒ†ã‚¹ãƒˆå†…å®¹.md` ã®ã€Œ## 14. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºï¼ˆæ›´æ–°ç‰ˆï¼‰ã€
- **TDDæ‰‹æ³•**: `ãƒ†ã‚¹ãƒˆå†…å®¹.md` ã®ã€Œ## ãƒ†ã‚¹ãƒˆæ–¹é‡ã€

---

## C#å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### ãƒ•ã‚¡ã‚¤ãƒ«å‘½åãƒ»é…ç½®è¦å‰‡
- **1ã‚¯ãƒ©ã‚¹1ãƒ•ã‚¡ã‚¤ãƒ«**: å„ã‚¯ãƒ©ã‚¹ã¯ç‹¬ç«‹ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«é…ç½®
- **ãƒ•ã‚¡ã‚¤ãƒ«å=ã‚¯ãƒ©ã‚¹å**: `ConnectionResponse.cs` = `public class ConnectionResponse`
- **Pascal Case**: å…¨ã¦ã®ã‚¯ãƒ©ã‚¹åãƒ»ãƒ•ã‚¡ã‚¤ãƒ«åã¯Pascal Case
- **ãƒ•ã‚©ãƒ«ãƒ€åˆ†é¡**: æ©Ÿèƒ½åˆ¥ã«ãƒ•ã‚©ãƒ«ãƒ€ã§åˆ†é¡ï¼ˆModels, Managers, Interfacesç­‰ï¼‰

### åå‰ç©ºé–“æ§‹é€ ï¼ˆæ¨å¥¨ï¼‰
```csharp
namespace Andon.Core.Models                    // ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
namespace Andon.Core.Managers                  // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
namespace Andon.Core.Interfaces               // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
namespace Andon.Infrastructure.Logging        // ãƒ­ã‚°æ©Ÿèƒ½
namespace Andon.Infrastructure.Configuration  // è¨­å®šç®¡ç†
namespace Andon.Infrastructure.Network        // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡
namespace Andon.Utilities                     // æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
namespace Andon.Tests.Unit                    // å˜ä½“ãƒ†ã‚¹ãƒˆ
namespace Andon.Tests.Integration             // çµ±åˆãƒ†ã‚¹ãƒˆ
```

### ä¾å­˜é–¢ä¿‚ç®¡ç†
- **NuGet ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ¨å¥¨**:
  - ClosedXML: xlsxèª­ã¿è¾¼ã¿
  - xUnit: ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
  - Moq: ãƒ¢ãƒƒã‚¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
  - Serilog: æ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- **å‚ç…§æ–¹å‘**: Infrastructure â†’ Core, Tests â†’ Core/Infrastructure

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¨™æº–
- **éåŒæœŸãƒ¡ã‚½ãƒƒãƒ‰**: å…¨I/Oæ“ä½œã¯Async/awaitä½¿ç”¨
- **ä¾‹å¤–å‡¦ç†**: å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§é©åˆ‡ãªä¾‹å¤–ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **nullå®‰å…¨æ€§**: nullable reference typesä½¿ç”¨
- **è¨­å®šå¤–éƒ¨åŒ–**: appsettings.xlsx + ç’°å¢ƒå¤‰æ•°å¯¾å¿œ

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ–¹é‡
- **ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ç¢ºä¿**: å…¨ä¸»è¦ã‚¯ãƒ©ã‚¹ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…
- **ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–å¯¾å¿œ**: ãƒ†ã‚¹ãƒˆæ™‚ã®å¤–éƒ¨ä¾å­˜æ’é™¤
- **TDDæ‰‹æ³•ã‚µãƒãƒ¼ãƒˆ**: Red-Green-Refactorã‚µã‚¤ã‚¯ãƒ«å®Ÿè¡Œæ”¯æ´
- **å¥‘ç´„ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ**: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§å…¥å‡ºåŠ›ã‚’æ˜ç¢ºåŒ–

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …
- **ãƒ¡ãƒ¢ãƒªç®¡ç†**: IDisposableå®Ÿè£…ã€using statementä½¿ç”¨
- **éåŒæœŸå‡¦ç†**: ConfigureAwait(false) ä½¿ç”¨
- **ãƒ­ã‚°å‡ºåŠ›**: æ§‹é€ åŒ–ãƒ­ã‚°ã§æ€§èƒ½æƒ…å ±è¨˜éŒ²
- **ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–**: ResourceManagerã§å®šæœŸç›£è¦–

---

## é…å¸ƒãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ

### é…å¸ƒå½¢æ…‹
**å˜ä¸€å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ (.NET Core Self-Contained)**

#### é…å¸ƒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ
```
AndonSystem-v1.0.zip
â””â”€â”€ å±•é–‹å¾Œ:
    â”œâ”€â”€ andon.exe                    // ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« (ç´„50-100MB)
    â”œâ”€â”€ config/
    â”‚   â”œâ”€â”€ appsettings.xlsx        // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (å¿…é ˆ)
    â”‚   â””â”€â”€ appsettings.sample.xlsx // ã‚µãƒ³ãƒ—ãƒ«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
    â””â”€â”€ docs/
        â”œâ”€â”€ README.txt              // åˆ©ç”¨èª¬æ˜æ›¸
        â””â”€â”€ è¨­å®šé …ç›®èª¬æ˜.md         // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°èª¬æ˜
```

#### å®Ÿè¡Œæ™‚ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€  (è‡ªå‹•ç”Ÿæˆ)
```
[andon.exeé…ç½®å ´æ‰€]/
â”œâ”€â”€ andon.exe                       // å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ PLC1_settings.xlsx         // PLC1å·æ©Ÿè¨­å®š (è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ)
â”‚   â”œâ”€â”€ PLC2_settings.xlsx         // PLC2å·æ©Ÿè¨­å®š
â”‚   â””â”€â”€ PLC3_settings.xlsx         // PLC3å·æ©Ÿè¨­å®š
â””â”€â”€ logs/                          // ğŸ“ æ›¸ãè¾¼ã¿æ¨©é™å¿…è¦ (å®Ÿè¡Œæ™‚è‡ªå‹•ä½œæˆ)
    â”œâ”€â”€ terminal_output.txt        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°
    â””â”€â”€ rawdata_analysis.json      // è©³ç´°ãƒ­ã‚°
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†æ–¹é‡

#### è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ
**å…±æœ‰ãƒ‡ãƒ¼ã‚¿ + è»½é‡ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**
- **è¤‡æ•°PLCå¯¾å¿œ**: `config/` ãƒ•ã‚©ãƒ«ãƒ€å†…ã®è¤‡æ•° `*_settings.xlsx` ã‚’è‡ªå‹•èª­ã¿è¾¼ã¿
- **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: è¨­å®šãƒ‡ãƒ¼ã‚¿ã¯é™çš„å…±æœ‰ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯è»½é‡åŒ–
- **ä¿å®ˆæ€§ç¶­æŒ**: æ—¢å­˜ã®å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä¿æŒ

#### åŸºæœ¬è¨­å®šæ–¹é‡
**å¤–éƒ¨è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å¿…é ˆå½¢å¼**
- å®Ÿè¡Œå‰ã« `config/` ãƒ•ã‚©ãƒ«ãƒ€å†…ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«é…ç½®ãŒå¿…é ˆ
- **å‘½åè¦å‰‡**: `*_settings.xlsx` (ä¾‹: PLC1_settings.xlsx)
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¸å­˜åœ¨æ™‚ã¯è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é…ç½®å ´æ‰€ã‚’æ¡ˆå†…
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«äº’æ›æ€§: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—æ™‚ã‚‚ä½¿ã„ã¾ã‚ã—å¯èƒ½

### æ¨©é™ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

#### å®Ÿè¡Œæ¨©é™
- **ç®¡ç†è€…æ¨©é™**: ä¸è¦
- **å®Ÿè¡Œå ´æ‰€åˆ¶é™**: ãªã— (ã©ã“ã‹ã‚‰ã§ã‚‚å®Ÿè¡Œå¯èƒ½)
- **ä¾å­˜é–¢ä¿‚**: ãªã— (.NET Runtimeå†…è”µ)

#### æ›¸ãè¾¼ã¿æ¨©é™ä»•æ§˜
- **æ›¸ãè¾¼ã¿å…ˆ**: `./logs/` (å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ç›¸å¯¾)
- **æ¨©é™ãƒã‚§ãƒƒã‚¯**: èµ·å‹•æ™‚äº‹å‰ãƒã‚§ãƒƒã‚¯å®Ÿæ–½
- **ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ**: è‡ªå‹•ä½œæˆ (logs ãƒ•ã‚©ãƒ«ãƒ€ä¸å­˜åœ¨æ™‚)
- **æ¨©é™ã‚¨ãƒ©ãƒ¼æ™‚**: ä»£æ›¿å ´æ‰€å‡ºåŠ› (`%TEMP%/AndonSystem/logs/`) + ãƒ‘ã‚¹è¡¨ç¤º
- **ãƒ­ã‚°å¤±æ•—æ™‚**: è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼æ‰±ã„ (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†)

### ãƒ‘ã‚¹è§£æ±ºãƒ»è¨­å®šèª­ã¿è¾¼ã¿ä»•æ§˜

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¢ç´¢é †åº
```csharp
1. ./config/appsettings.xlsx        (å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ç›¸å¯¾ãƒ»æœ€å„ªå…ˆ)
2. ./appsettings.xlsx               (å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«åŒéšå±¤ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯)
3. ç’°å¢ƒå¤‰æ•° ANDON_CONFIG_PATH       (ã‚«ã‚¹ã‚¿ãƒ ãƒ‘ã‚¹æŒ‡å®š)
```

#### å®Ÿè¡Œæ™‚ãƒ‘ã‚¹è§£æ±º
```csharp
åŸºæº–ãƒ‘ã‚¹: Assembly.GetExecutingAssembly().Location
ãƒ­ã‚°å‡ºåŠ›: Path.Combine(åŸºæº–ãƒ‘ã‚¹, "logs")
è¨­å®šèª­è¾¼: Path.Combine(åŸºæº–ãƒ‘ã‚¹, "config", "appsettings.xlsx")
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

#### æ›¸ãè¾¼ã¿æ¨©é™ã‚¨ãƒ©ãƒ¼
- **1æ¬¡å‡¦ç†**: ä»£æ›¿å ´æ‰€ (`%TEMP%/AndonSystem/logs/`) ã«å‡ºåŠ›
- **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«è¡¨ç¤º**: ä»£æ›¿ãƒ‘ã‚¹æƒ…å ±ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
- **æœ€çµ‚åˆ¤å®š**: ä»£æ›¿å ´æ‰€ã‚‚å¤±æ•—æ™‚ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†

#### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¸å­˜åœ¨ã‚¨ãƒ©ãƒ¼
- **æ¢ç´¢çµæœè¡¨ç¤º**: ç¢ºèªæ¸ˆã¿ãƒ‘ã‚¹ä¸€è¦§
- **ç¾åœ¨å®Ÿè¡Œå ´æ‰€**: å®Ÿéš›ã®ãƒ‘ã‚¹æƒ…å ±è¡¨ç¤º
- **å‡¦ç†**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

#### ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º
- **ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³**: `andon.exe --version`
- **å®Ÿè¡Œæ™‚**: èµ·å‹•ãƒ­ã‚°ã«è‡ªå‹•è¡¨ç¤º
- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**: å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±

#### ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã®äº’æ›æ€§
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: æ—¢å­˜ã® appsettings.xlsx ã‚’ä½¿ã„ã¾ã‚ã—
- **ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«**: æ—¢å­˜ãƒ­ã‚°ã‚’ä¿æŒãƒ»ç¶™ç¶šè¨˜éŒ²
- **ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ **: å¤‰æ›´æ™‚ã¯æ—§æ§‹é€ ã‚‚è‡ªå‹•èªè­˜

### æŠ€è¡“ä»•æ§˜

#### èµ·å‹•æ™‚å‡¦ç†é †åº
1. æ›¸ãè¾¼ã¿æ¨©é™äº‹å‰ãƒã‚§ãƒƒã‚¯ (`./logs/` â†’ å¤±æ•—æ™‚ `%TEMP%/AndonSystem/logs/`)
2. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¢ç´¢ãƒ»èª­ã¿è¾¼ã¿ (`./config/*_settings.xlsx` â†’ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯)
3. å¿…è¦ãƒ•ã‚©ãƒ«ãƒ€è‡ªå‹•ä½œæˆ (`logs` ãƒ•ã‚©ãƒ«ãƒ€)
4. ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºå¾Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆï¼ˆãƒãƒ©ãƒ³ã‚¹å‹ï¼‰
- **ä¾‹å¤–æ–¹å¼**: æ··åœ¨å‹ï¼ˆé‡è¦ä¾‹å¤–ã®ã¿ã‚«ã‚¹ã‚¿ãƒ ã€ä»–ã¯æ¨™æº–ä¾‹å¤–ï¼‰
  - ã‚«ã‚¹ã‚¿ãƒ ä¾‹å¤–: `MultiConfigLoadException` (è¤‡æ•°è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨)
  - æ¨™æº–ä¾‹å¤–: `FileNotFoundException`, `IOException`, `UnauthorizedAccessException`
- **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†**: å®šæ•°ã‚¯ãƒ©ã‚¹ (`ErrorMessages.cs`) ã§çµ±ä¸€ç®¡ç†
- **æ¨©é™ãƒã‚§ãƒƒã‚¯**: å˜ç´”ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ†ã‚¹ãƒˆã§ç¢ºå®Ÿæ€§é‡è¦–

#### å®Ÿè¡Œç’°å¢ƒ
- **Target Framework**: .NET 6.0 ä»¥ä¸Š
- **é…å¸ƒå½¢å¼**: Self-Contained Deployment
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: x64 (Windows 10/11 å¯¾å¿œ)
- **å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º**: ç´„50-100MB

---

## ä½œæˆæ—¥æ™‚
- **åˆå›ä½œæˆ**: 2025å¹´1æœˆ29æ—¥
- **æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ21æ—¥
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.6 (Phase4-6ä»•æ§˜å¤‰æ›´å¯¾å¿œ: DeviceEntry/DeviceData/ProcessedDeviceRequestInfoè¿½åŠ )

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025-11-25 | 1.7 | DeviceEntryInfoè¿½åŠ ï¼ˆPhase7ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›å‡¦ç†å¯¾å¿œï¼‰ |
| 2025-11-21 | 1.6 | Modelsã‚¯ãƒ©ã‚¹ä¸€è¦§æ›´æ–°: DeviceEntry/DeviceData/ProcessedDeviceRequestInfoè¿½åŠ ã€Phase4-6ä»•æ§˜å¤‰æ›´åæ˜  |
| 2025-11-21 | 1.5 | è¤‡æ•°PLCä¸¦åˆ—å‡¦ç†å¯¾å¿œ: MultiPlcCoordinator, ExecutionOrchestratoræ‹¡å¼µ, é–¢é€£ãƒ¢ãƒ‡ãƒ«è¿½åŠ  |
| 2025-02-06 | 1.4 | ãƒ†ã‚¹ãƒˆå†…å®¹.mdã¨ã®å¯¾å¿œé–¢ä¿‚ã‚’æ˜ç¢ºåŒ–ã€Phaseåˆ¥ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œè¡¨ã‚’è¿½åŠ  |
| 2025-01-29 | 1.0 | åˆç‰ˆä½œæˆ |