PLCデータ取得アプリ動作フロー

Step1
範囲：アプリケーション
動作：設定ファイル条件の​読み込み
成功条件：
    ・設定ファイルに記載されている値を正確に取得できること
    ・必要な値が設定されていない場合はエラーを返すこと

Step2
範囲：アプリケーション
動作：通信フレームの​構築
成功条件：
    ・Step1で取得した値から正しい内容のフレームを生成できること

Step3
範囲：アプリケーション
動作：PLCへの​接続処理
成功条件：
    ・読み込んだ設定ファイルの情報から意図した機器に接続処理ができる
    ・接続に失敗した場合はエラーを返すこと

詳細フロー：
    1. ソケット作成
    2. 接続実行
    3. 接続成功判定（失敗時はエラーをスロー）
    4. タイムアウト設定（送信・受信）
    5. 接続情報記録
    6. 接続情報返却

Step4
範囲：アプリケーション/PLC
動作：PLCに​リクエストを​送信/リクエスト情報に​従って​レスポンスを受信
成功条件：
    ・設定ファイルで指定した機器に対するリクエスト送信/レスポンス受信ができる

詳細フロー：

Step4-1 リクエスト送信
    1. 接続情報チェック（接続情報 == True?）
    2. 接続が確認できない場合はエラーをスロー
    3. 構築済みフレーム送信
    4. 送信完了確認（送信完了?）
    5. 送信失敗時はエラーをスロー
    6. 送信統計記録
        ・送信フレーム数 +1
        ・送信バイト数加算
        ・送信時刻記録
    7. void返却

Step4-2 データ受信
    1. PLCレスポンス待機
    2. タイムアウト内で受信確認（タイムアウト内で受信?）
    3. タイムアウト時は時間内に受信無しのメッセージ出力
    4. 受信統計記録
        ・受信フレーム数 +1
        ・受信バイト数加算
        ・受信時刻記録
    5. 生データ(16進数)返却

Step5
範囲：アプリケーション
動作：接続切断処理
成功条件：
    ・正常に接続切断処理が完了できる

詳細フロー：
    1. 切断要求
    2. 接続状態チェック（接続中?）
    3. 未接続の場合は切断完了済メッセージ出力
    4. 通信全体の統計情報収集
        ・接続時間
        ・送信フレーム数
        ・受信フレーム数
        ・送信バイト数
        ・受信バイト数
        ・応答時間統計
        ・エラー回数
        ・通信成功率
    5. ソケットシャットダウン
    6. ソケットクローズ
    7. ソケット破棄
    8. 内部状態初期化
    9. 接続状態返却

Step6
範囲：アプリケーション
動作：受信データ解析
成功条件：
    ・PLCから受信したデータ(16進数)から正しい内容の構造化データに変換できること
データ破損時の対応方針（継続実行モード）：
    ・ParseRawToStructuredDataで壊れたデータを検出
    ・エラーログ出力後、次サイクル継続
    ・正常データのみ処理、異常データは破棄

Step7
範囲：アプリケーション
動作：解析後​データの​出力
成功条件：
    ・解析したデータを任意の場所/形式に出力/保存できる

実行パターン

基本実行フロー
    ・初期化フェーズ（1回実行）: Step1
    ・データ処理サイクル（繰り返し実行）: Step2-7

継続実行モード
範囲：アプリケーション
動作：Step1で作成したインスタンスを使用して、Step2-7を周期的に繰り返し実行
実行順序：
    1. Step1（初期設定・インスタンス作成） - アプリケーション起動時に1回のみ実行
        ・設定ファイル読み込み
        ・各種マネージャークラスのインスタンス作成
        ・初期化処理完了

    2. Step2-7（データ処理サイクル） - MonitoringIntervalMs間隔で繰り返し実行
        ・Step2: 通信フレーム構築（作成済みインスタンス使用）
        ・Step3: PLC接続処理
        ・Step4: データ送受信
        ・Step5: PLC切断処理
        ・Step6: 受信データ解析（データ破損時は次サイクルで回復）
        ・Step7: データ出力
        ・待機: MonitoringIntervalMs待機後、Step2に戻る

制御設定：
    ・MonitoringIntervalMs: データ収集周期（各ステップio.md L36参照）
    ・ContinuousDataMode: 継続データモード有効化（各ステップio.md L48参照）

成功条件：
    ・Step1で作成したインスタンスが各サイクルで正常に動作すること
    ・MonitoringIntervalMs間隔での安定した周期実行ができること
    ・エラー発生時も継続実行が維持されること（エラーハンドリング機能との連携）
    ・データ破損等の一時的な異常でもアプリケーション停止せず次サイクルで回復すること