################################################################################
# PLC単一通信テストプログラム（フレーム解析機能統合版）
################################################################################

【テスト内容】
- ハードコードされたデータをPLCに送信
- 受信データの自動解析（3E/4E対応）
- デバイス値の詳細表示

【接続設定】
  PLC IP       : 172.30.40.15
  PLC Port     : 8192
  プロトコル   : UDP
  タイムアウト : 500ms

================================================================================

[確認] ✓ 送信データ準備完了: 213バイト

[構築] 送信データ (213バイト):
  54 00 00 00 00 00 00 FF FF 03 00 C8 00 20 00 03 04 00 00 30 00 48 EE 00 A8 4B EE 00 A8 52 EE 00 A8 5C EE 00 A8 AA 18 01 A8 DC 18 01 A8 A4 19 01 A8 B8 19 01 A8 CC 19 01 A8 E0 19 01 A8 20 00 00 90 B2 DE 00 90 7A DF 00 90 DE DF 00 90 50 E0 00 90 61 E0 00 90 A6 E0 00 90 BB E0 00 90 CE E0 00 90 E0 06 00 9C F0 06 00 9C 04 07 00 9C 20 07 00 9C 40 07 00 9C 50 07 00 9C 67 07 00 9C 77 07 00 9C 89 07 00 9C 9A 07 00 9C AE 07 00 9C BE 07 00 9C DE 07 00 9C 22 08 00 9C 32 08 00 9C 45 08 00 9C 55 08 00 9C 68 08 00 9C 08 17 00 9C 20 17 00 9C 30 17 00 9C 48 17 00 9C 60 17 00 9C 70 17 00 9C 82 17 00 9C A0 17 00 9C 00 09 00 9D 20 09 00 9D 40 09 00 9D

[構築] 送信データHEX（詳細）:
  0000: 54 00 00 00 00 00 00 FF FF 03 00 C8 00 20 00 03  T............ ..
  0010: 04 00 00 30 00 48 EE 00 A8 4B EE 00 A8 52 EE 00  ...0.H...K...R..
  0020: A8 5C EE 00 A8 AA 18 01 A8 DC 18 01 A8 A4 19 01  .\..............
  0030: A8 B8 19 01 A8 CC 19 01 A8 E0 19 01 A8 20 00 00  ............. ..
  0040: 90 B2 DE 00 90 7A DF 00 90 DE DF 00 90 50 E0 00  .....z.......P..
  0050: 90 61 E0 00 90 A6 E0 00 90 BB E0 00 90 CE E0 00  .a..............
  0060: 90 E0 06 00 9C F0 06 00 9C 04 07 00 9C 20 07 00  ............. ..
  0070: 9C 40 07 00 9C 50 07 00 9C 67 07 00 9C 77 07 00  .@...P...g...w..
  0080: 9C 89 07 00 9C 9A 07 00 9C AE 07 00 9C BE 07 00  ................
  0090: 9C DE 07 00 9C 22 08 00 9C 32 08 00 9C 45 08 00  ....."...2...E..
  00A0: 9C 55 08 00 9C 68 08 00 9C 08 17 00 9C 20 17 00  .U...h....... ..
  00B0: 9C 30 17 00 9C 48 17 00 9C 60 17 00 9C 70 17 00  .0...H...`...p..
  00C0: 9C 82 17 00 9C A0 17 00 9C 00 09 00 9D 20 09 00  ............. ..
  00D0: 9D 40 09 00 9D                                   .@...

[接続] 172.30.40.15:8192 へ接続中...
[確認] ✓ 接続成功

[送信] データ送信中 (213バイト)...
[確認] ✓ 送信完了 (213バイト)

[受信] レスポンス受信中（タイムアウト: 500ms）...
[受信] 完了: 111 バイト

[受信] レスポンスHEX:
  0000: D4 00 00 00 00 00 00 FF FF 03 00 62 00 00 00 FF  ...........b....
  0010: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ................
  0020: FF FF FF 07 19 FF FF FF FF FF FF FF FF FF FF FF  ................
  0030: FF FF FF FF FF 00 10 00 08 00 01 00 10 00 10 00  ................
  0040: 08 20 00 10 00 08 00 02 00 00 00 00 00 00 00 00  . ..............
  0050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
  0060: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     ...............

[受信] レスポンス生データ:
  D4 00 00 00 00 00 00 FF FF 03 00 62 00 00 00 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 07 19 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 00 10 00 08 00 01 00 10 00 10 00 08 20 00 10 00 08 00 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

================================================================================
[解析] フレーム解析開始
================================================================================
[判定] フレームタイプ: 4E
[判定] サブヘッダ: 0xD4 0x00

[解析] 4Eフレーム構造:
  シーケンス番号  : 0x0000
  予約            : 0x0000
  ネットワーク番号: 0x00
  PC番号          : 0xFF
  I/O番号         : 0x03FF
  局番            : 0x00
  データ長        : 98バイト
  終了コード      : 0x0000 (正常)

[解析] デバイスデータ (96バイト):
  0000: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF  ................
  0010: FF FF FF FF 07 19 FF FF FF FF FF FF FF FF FF FF  ................
  0020: FF FF FF FF FF FF 00 10 00 08 00 01 00 10 00 10  ................
  0030: 00 08 20 00 10 00 08 00 02 00 00 00 00 00 00 00  .. .............
  0040: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
  0050: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................

[解析] デバイス値（ワード型、リトルエンディアン）:
  D  0: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  1: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  2: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  3: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  4: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  5: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  6: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  7: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  8: 0xFFFF (65535) [Byte: 0xFF 0xFF]
  D  9: 0xFFFF (65535) [Byte: 0xFF 0xFF]

[解析] デバイス値（ビット型、各バイト内のビット）:
  M  0: 1 1 1 1 1 1 1 1 1 1
  M 10: 1 1 1 1 1 1 1 1 1 1
  M 20: 1 1 1 1 1 1 1 1 1 1
  M 30: 1 1 1 1 1 1 1 1 1 1
  M 40: 1 1 1 1 1 1 1 1 1 1
  M 50: 1 1 1 1 1 1 1 1 1 1
  M 60: 1 1 1 1 1 1 1 1 1 1
  M 70: 1 1 1 1 1 1 1 1 1 1
================================================================================

================================================================================
[完了] プログラムが正常終了しました
================================================================================

終了するにはEnterキーを押してください...
