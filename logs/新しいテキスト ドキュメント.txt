================================================
       SLMP Raw Data Logging Script
================================================

This script runs andon.exe with raw data
analysis and logging features enabled.

Log output destinations:
- Raw Data Log: logs/rawdata_analysis.log
- Raw Data JSON: logs/rawdata_analysis.json
- Terminal Output: logs/terminal_output.txt

================================================

Running andon.exe in continuous monitoring mode...

Press Ctrl+C to stop continuous execution

===================================================
    SLMP インテリジェント監視システム v2.0
    全39デバイス対応・完全探索システム
===================================================

?? 現在のディレクトリ: C:\Users\PPESAdmin\Desktop\dist
?? 設定ファイル存在確認: C:\Users\PPESAdmin\Desktop\dist\appsettings.json -> ? 存在
?? 設定確認: DeviceDiscoverySettings:DiscoveryMode = 'Basic'
実行モード: IntelligentMonitoring (6ステップフロー)

info: SlmpClient.Core.IntegratedOutputManager[0]
      === セッション開始 ===
?? インテリジェント監視システム開始
6ステップフロー:
1. 設定ファイルで接続するPLCを決定
2. PLCに接続し機器情報を取得
3. 機器情報からシリーズを判定し、デバイスコードを抽出
4. 全デバイスコード＋一般的な機器番号で網羅的スキャン
5. 応答があった(非ゼロデータ)デバイスを抽出
6. 抽出したデバイスのデータのみを継続的に取得

info: SlmpClient.Core.IntegratedOutputManager[0]
      ?? セッションID: session_20251003_082008
info: SlmpClient.Core.IntegratedOutputManager[0]
      ?? アプリケーション: SLMP インテリジェント監視システム vv2.0
info: SlmpClient.Core.IntegratedOutputManager[0]
      ?? 接続先: 全39デバイス対応・完全探索システム
info: SlmpClient.Core.IntegratedOutputManager[0]
      ?? モード: ReturnDefaultAndContinue
info: SlmpClient.Core.IntegratedOutputManager[0]
      ?? ログ出力: logs/rawdata_analysis.log
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      設定値読み込み: DeviceDiscoverySettings:DiscoveryMode = 'Basic'
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      ? DiscoveryMode設定適用成功: Basic
? 依存性注入設定完了 - IntelligentMonitoringSystem準備完了

?? 6ステップフロー実行開始
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      システム状態変更: Idle → Discovering
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      === 6ステップフロー実行開始 ===
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 1実行: 設定ファイルからPLC接続情報を取得
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 1成功: PLC接続先='製造ラインPLC' (172.30.40.15:8192)
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 1完了: PLC接続先='製造ラインPLC' (172.30.40.15:8192)
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 2実行: PLC 製造ラインPLC に接続し機器情報を取得
info: SlmpClient.Core.SlmpClient[0]
      Connecting to 172.30.40.15:8192
info: SlmpClient.Core.SlmpClient[0]
      Successfully connected to 172.30.40.15:8192
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 2: PLC接続成功 (製造ラインPLC)
warn: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 2でReadTypeName失敗、フォールバック処理を実行: SLMP communication error: 1023 (0x03FF) - 未定義エラー (0x03FF)
      SlmpClient.Exceptions.SlmpCommunicationException: SLMP communication error: 1023 (0x03FF) - 未定義エラー (0x03FF)
         at SlmpClient.Serialization.SlmpResponseParserCore.ParseBinaryResponse(Byte[] responseFrame, SlmpFrameVersion version) in C:\Users\1010821\Desktop\python\andon\andon\Serialization\SlmpResponseParserCore.cs:line 109
         at SlmpClient.Serialization.SlmpResponseParserCore.ParseResponse(Byte[] responseFrame, Boolean isBinary, SlmpFrameVersion version) in C:\Users\1010821\Desktop\python\andon\andon\Serialization\SlmpResponseParserCore.cs:line 35
         at SlmpClient.Serialization.AutoDetectionFallbackProcessor.ProcessFallback(Byte[] responseFrame, Exception originalException, Boolean isBinary, SlmpFrameVersion version) in C:\Users\1010821\Desktop\python\andon\andon\Serialization\AutoDetectionFallbackProcessor.cs:line 48
         at SlmpClient.Serialization.SlmpResponseParser.ParseResponse(Byte[] responseFrame, Boolean isBinary, SlmpFrameVersion version) in C:\Users\1010821\Desktop\python\andon\andon\Serialization\SlmpResponseParser.cs:line 55
         at SlmpClient.Core.SlmpClient.ReadTypeNameAsync(UInt16 timeout, CancellationToken cancellationToken) in C:\Users\1010821\Desktop\python\andon\andon\Core\SlmpClient.cs:line 1103
         at SlmpClient.Core.IntelligentMonitoringSystem.Step2_ConnectAndGetDeviceInfoAsync(PlcConnectionInfo connectionInfo, CancellationToken cancellationToken) in C:\Users\1010821\Desktop\python\andon\andon\Core\IntelligentMonitoringSystem.cs:line 437
Timestamp: 2025-10-02 23:20:08.886 UTC
EndCode: 1023 (0x03FF)
EndCode Message: 未定義エラー (0x03FF)
Severity: Error
IsRetryable: False
ResponseData Length: 20 bytes
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      フォールバック処理開始: ReadTypeName代替手段を試行
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 2フォールバック成功: 接続先='製造ラインPLC', TypeCode=Q00CPU (推定値)
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 2完了: 接続成功=True, 型名='Unknown', TypeCode=Q00CPU
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 3実行: TypeCode Q00CPU からシリーズ判定・デバイスコード抽出
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 3成功: 探索設定概要: ビット6種類, ワード2種類, 総アドレス数45056, 高優先度2種類, 高頻度使用4種類, バッチサイ ズ64, 最大同時スキャン4
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 3完了: ビット6種類, ワード2種類
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 4実行: 全デバイスコード＋一般的機器番号で網羅的スキャン
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 4成功: 総スキャン数 45056個, アクティブ 0個を検出
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 4完了: 総スキャン数 45056個, アクティブ 0個を検出
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 5実行: 非ゼロデータデバイス抽出
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 5成功: 0個の非ゼロデータデバイスを抽出 (0.0%)
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      === Step 5: 抽出されたアクティブデバイス詳細 ===
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 5完了: 非ゼロデータデバイス 0個を抽出
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      Step 6: 非ゼロデータデバイスが0個のため継続監視はスキップ
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      システム状態変更: Discovering → Idle
info: SlmpClient.Core.IntelligentMonitoringSystem[0]
      === 6ステップフロー実行完了 ===
? 6ステップフロー実行完了
?? PLC型名: Unknown (Q00CPU)
?? 実行時間: 1.5秒
?? 監視開始: No

===================================================
実行完了
===================================================

================================================
Execution completed.

Please check log files:
[ERROR] Raw data log file was not created
[OK] Raw data JSON file: logs\rawdata_analysis.json created
[OK] Terminal output file: logs\terminal_output.txt created
================================================
続行するには何かキーを押してください . . .